<!doctype html>
<html lang="tr">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SOMTECH SOF ERP v9.0</title>
  <script src="/_sdk/element_sdk.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&amp;family=Roboto:wght@300;400;500;700&amp;display=swap" rel="stylesheet">
  <style>
        :root {
            /* Dark Theme (Default) */
            --bg-primary: #0F1115;
            --bg-secondary: #151922;
            --bg-tertiary: #1E293B;
            --text-primary: #E5E7EB;
            --text-secondary: #9CA3AF;
            --text-tertiary: #6B7280;
            --accent-primary: #22D3EE;
            --accent-secondary: #38BDF8;
            --accent-gradient: linear-gradient(135deg, #22D3EE, #38BDF8);
            --border-primary: rgba(34, 211, 238, 0.3);
            --border-secondary: #374151;
            --glass-bg: rgba(21, 25, 34, 0.95);
            --glass-border: rgba(34, 211, 238, 0.3);
            --success-color: #22C55E;
            --error-color: #EF4444;
            --warning-color: #F59E0B;
            --info-color: #3B82F6;
            --sidebar-width: 280px;
        }

        [data-theme="light"] {
            /* Light Theme */
            --bg-primary: #F9FAFB;
            --bg-secondary: #FFFFFF;
            --bg-tertiary: #E5E7EB;
            --text-primary: #111827;
            --text-secondary: #4B5563;
            --text-tertiary: #6B7280;
            --accent-primary: #2563EB;
            --accent-secondary: #3B82F6;
            --accent-gradient: linear-gradient(135deg, #2563EB, #3B82F6);
            --border-primary: rgba(37, 99, 235, 0.3);
            --border-secondary: #D1D5DB;
            --glass-bg: rgba(255, 255, 255, 0.8);
            --glass-border: rgba(37, 99, 235, 0.3);
            --success-color: #059669;
            --error-color: #DC2626;
            --warning-color: #D97706;
            --info-color: #2563EB;
        }

        /* Role-based themes */
        [data-role="user"] {
            --role-primary: #6B7280;
            --role-secondary: #3B82F6;
            --role-gradient: linear-gradient(135deg, #6B7280, #3B82F6);
        }

        [data-role="manager"] {
            --role-primary: #F59E0B;
            --role-secondary: #EF4444;
            --role-gradient: linear-gradient(135deg, #F59E0B, #EF4444);
        }

        [data-role="procurement"] {
            --role-primary: #1E40AF;
            --role-secondary: #EF4444;
            --role-gradient: linear-gradient(135deg, #1E40AF, #EF4444);
        }

        [data-role="accounting"] {
            --role-primary: #059669;
            --role-secondary: #6B7280;
            --role-gradient: linear-gradient(135deg, #059669, #6B7280);
        }

        body {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Inter', 'Roboto', sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100%;
            overflow-x: hidden;
            transition: all 0.4s ease;
        }

        html, body {
            height: 100%;
        }

        * {
            box-sizing: border-box;
        }

        /* Login Screen */
        .login-screen {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: #0F1115;
            opacity: 0.95;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            transition: all 0.4s ease;
        }

        .login-container {
            background: rgba(21, 25, 34, 0.95);
            backdrop-filter: blur(12px);
            border: 2px solid rgba(34, 211, 238, 0.3);
            border-radius: 18px;
            padding: 3rem;
            width: 90%;
            max-width: 450px;
            text-align: center;
            box-shadow: 0 8px 32px rgba(34, 211, 238, 0.3);
            transition: all 0.4s ease;
        }

        .login-logo {
            width: 100px;
            height: 100px;
            border-radius: 16px;
            object-fit: contain;
            margin: 0 auto 8px auto;
            display: block;
            transition: all 0.3s ease;
            cursor: pointer;
            filter: drop-shadow(0 0 10px rgba(34, 211, 238, 0.6));
        }

        .login-logo:hover {
            transform: scale(1.05);
            filter: drop-shadow(0 0 15px rgba(34, 211, 238, 0.8));
        }

        .login-title {
            font-family: 'Inter', sans-serif;
            font-size: 1.5rem;
            font-weight: 500;
            color: #E5E7EB;
            margin: 24px 0 8px 0;
            text-align: center;
        }

        .login-subtitle {
            font-family: 'Inter', sans-serif;
            font-size: 0.875rem;
            color: #E5E7EB;
            margin-bottom: 24px;
            font-weight: 400;
            line-height: 1.5;
            text-align: center;
        }

        .login-form {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }

        .login-input-group {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
            text-align: left;
        }

        .login-label {
            font-size: 0.875rem;
            color: var(--text-secondary);
            font-weight: 500;
        }

        .login-input {
            background: var(--bg-secondary);
            border: 2px solid var(--border-secondary);
            color: var(--text-primary);
            padding: 1rem;
            border-radius: 12px;
            font-size: 0.875rem;
            transition: all 0.4s ease;
            font-family: 'Inter', sans-serif;
        }

        .login-input:focus {
            outline: none;
            border-color: var(--accent-primary);
            box-shadow: 0 0 15px var(--border-primary);
        }

        .login-button {
            background: linear-gradient(135deg, #22D3EE, #3B82F6);
            border: none;
            color: white;
            padding: 1rem 2rem;
            border-radius: 12px;
            cursor: pointer;
            font-weight: 600;
            font-size: 1rem;
            transition: all 0.4s ease;
            box-shadow: 0 6px 20px rgba(34, 211, 238, 0.4);
            font-family: 'Inter', sans-serif;
            position: relative;
            overflow: hidden;
            margin-bottom: 16px;
        }

        .login-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(34, 211, 238, 0.5);
            filter: brightness(1.1);
        }

        .login-button:active {
            transform: translateY(0);
        }

        .login-controls {
            display: flex;
            justify-content: center;
            gap: 12px;
            margin-top: 0;
        }

        .login-control-btn {
            width: 48px;
            height: 48px;
            border-radius: 12px;
            background: var(--bg-secondary);
            border: 2px solid var(--border-secondary);
            color: var(--accent-primary);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            transition: all 0.4s ease;
        }

        .login-control-btn:hover {
            background: var(--border-primary);
            border-color: var(--accent-primary);
            transform: scale(1.05);
        }

        /* Main Layout */
        .app-container {
            display: none;
            height: 100vh;
            overflow: hidden;
        }

        .app-container.active {
            display: flex;
        }

        /* Sidebar */
        .sidebar {
            width: var(--sidebar-width);
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border-right: 2px solid var(--border-primary);
            display: flex;
            flex-direction: column;
            position: fixed;
            left: 0;
            top: 0;
            height: 100vh;
            z-index: 100;
            transition: all 0.4s ease;
            box-shadow: 4px 0 15px rgba(0, 0, 0, 0.1);
        }

        .sidebar-header {
            padding: 1.5rem;
            border-bottom: 2px solid var(--border-primary);
            text-align: center;
        }

        .sidebar-logo {
            width: 60px;
            height: 60px;
            border-radius: 12px;
            object-fit: contain;
            margin-bottom: 1rem;
        }

        .sidebar-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--text-primary);
            margin: 0;
        }

        .sidebar-menu {
            flex: 1;
            padding: 1rem 0;
            overflow-y: auto;
        }

        .menu-item {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem 1.5rem;
            color: var(--text-secondary);
            text-decoration: none;
            transition: all 0.3s ease;
            cursor: pointer;
            border-left: 3px solid transparent;
        }

        .menu-item:hover {
            background: var(--border-primary);
            color: var(--accent-primary);
            border-left-color: var(--accent-primary);
        }

        .menu-item.active {
            background: var(--border-primary);
            color: var(--accent-primary);
            border-left-color: var(--accent-primary);
        }

        .menu-icon {
            font-size: 1.2rem;
            width: 24px;
            text-align: center;
        }

        .menu-text {
            font-weight: 500;
            font-size: 0.9rem;
        }

        .sidebar-footer {
            padding: 1rem 1.5rem;
            border-top: 2px solid var(--border-primary);
        }

        .logout-btn {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            background: rgba(239, 68, 68, 0.1);
            border: 2px solid rgba(239, 68, 68, 0.3);
            border-radius: 12px;
            color: #EF4444;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
            text-align: left;
        }

        .logout-btn:hover {
            background: rgba(239, 68, 68, 0.2);
            transform: translateY(-1px);
        }

        /* Main Content */
        .main-content {
            margin-left: var(--sidebar-width);
            height: 100vh;
            display: flex;
            flex-direction: column;
            transition: all 0.4s ease;
        }

        /* Corporate Top Bar */
        .top-bar {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border-bottom: 3px solid var(--accent-primary);
            padding: 1rem 2rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
            box-shadow: 0 2px 15px rgba(34, 211, 238, 0.2);
            z-index: 50;
            position: relative;
        }

        .top-bar::after {
            content: '';
            position: absolute;
            bottom: -3px;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, #22D3EE, #38BDF8, #22D3EE);
            box-shadow: 0 0 10px rgba(34, 211, 238, 0.5);
        }

        .top-left {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .top-logo {
            width: 48px;
            height: 48px;
            border-radius: 12px;
            object-fit: contain;
        }

        .system-title {
            font-size: 1.4rem;
            font-weight: 700;
            color: var(--text-primary);
            background: var(--accent-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .page-title-center {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--text-primary);
            text-align: center;
            flex: 1;
        }

        .top-controls {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .control-btn {
            width: 44px;
            height: 44px;
            border-radius: 12px;
            background: var(--bg-secondary);
            border: 2px solid var(--border-secondary);
            color: var(--accent-primary);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.1rem;
            transition: all 0.4s ease;
            position: relative;
        }

        .control-btn:hover {
            background: var(--border-primary);
            border-color: var(--accent-primary);
            transform: scale(1.05);
        }

        .user-menu-btn {
            background: var(--role-gradient, var(--accent-gradient));
            color: white;
            border-color: transparent;
            padding: 0 1rem;
            width: auto;
            min-width: 44px;
            font-weight: 600;
            font-size: 0.9rem;
        }

        /* Dropdowns */
        .dropdown {
            position: absolute;
            top: 100%;
            right: 0;
            margin-top: 8px;
            background: rgba(15, 17, 21, 0.95);
            backdrop-filter: blur(16px);
            border: 2px solid #22D3EE;
            border-radius: 10px;
            padding: 8px;
            min-width: 200px;
            max-height: 120px;
            overflow-y: auto;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
            opacity: 0;
            visibility: hidden;
            transform: translateY(-10px);
            transition: all 0.3s ease;
            z-index: 9999;
        }

        .login-control-btn {
            position: relative;
        }

        .dropdown.active {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        .dropdown::-webkit-scrollbar {
            width: 6px;
        }

        .dropdown::-webkit-scrollbar-track {
            background: rgba(34, 211, 238, 0.1);
            border-radius: 3px;
        }

        .dropdown::-webkit-scrollbar-thumb {
            background: #22D3EE;
            border-radius: 3px;
        }

        .dropdown-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            color: var(--text-primary);
            font-weight: 500;
            font-size: 0.9rem;
        }

        .dropdown-item:hover {
            background: var(--border-primary);
            color: var(--accent-primary);
        }

        .dropdown-item.active {
            background: var(--accent-primary);
            color: white;
        }

        /* Content Area */
        .content-area {
            flex: 1;
            padding: 2rem;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            position: relative;
        }

        /* Central Table Layout */
        .central-table-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            max-width: 1400px;
            margin: 0 auto;
            width: 100%;
        }

        /* Action Bar */
        .action-bar {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .action-left {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .action-right {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .primary-btn {
            background: var(--role-gradient, var(--accent-gradient));
            border: none;
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 12px;
            cursor: pointer;
            font-weight: 600;
            font-size: 0.9rem;
            transition: all 0.4s ease;
            box-shadow: 0 4px 15px rgba(34, 211, 238, 0.3);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .primary-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(34, 211, 238, 0.4);
            filter: brightness(1.1);
        }

        .secondary-btn {
            background: var(--bg-secondary);
            border: 2px solid var(--border-secondary);
            color: var(--text-primary);
            padding: 0.75rem 1.5rem;
            border-radius: 12px;
            cursor: pointer;
            font-weight: 600;
            font-size: 0.9rem;
            transition: all 0.4s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .secondary-btn:hover {
            background: var(--border-primary);
            border-color: var(--accent-primary);
            color: var(--accent-primary);
        }

        /* Filters */
        .filters-section {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border: 2px solid var(--border-primary);
            border-radius: 16px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .filters-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
            align-items: end;
        }

        .filter-group {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .filter-label {
            font-size: 0.875rem;
            color: var(--text-secondary);
            font-weight: 500;
        }

        .filter-input, .filter-select {
            background: var(--bg-secondary);
            border: 2px solid var(--border-secondary);
            color: var(--text-primary);
            padding: 0.75rem;
            border-radius: 8px;
            font-size: 0.875rem;
            transition: all 0.4s ease;
        }

        .filter-input:focus, .filter-select:focus {
            outline: none;
            border-color: var(--accent-primary);
            box-shadow: 0 0 15px var(--border-primary);
        }

        /* Corporate Data Table */
        .table-container {
            flex: 1;
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border: 2px solid var(--border-primary);
            border-radius: 16px;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            box-shadow: 0 8px 32px rgba(34, 211, 238, 0.1);
        }

        .table-wrapper {
            flex: 1;
            overflow: auto;
            position: relative;
        }

        .data-table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            min-width: 1400px;
        }

        .table-header {
            position: sticky;
            top: 0;
            z-index: 10;
            background: var(--bg-secondary);
        }

        .table-header th {
            background: var(--bg-secondary);
            color: var(--text-primary);
            padding: 1.2rem 1rem;
            text-align: left;
            font-weight: 600;
            font-size: 0.9rem;
            border-bottom: 3px solid var(--accent-primary);
            border-right: 1px solid var(--border-secondary);
            white-space: nowrap;
            position: relative;
        }

        .table-header th:last-child {
            width: 300px;
            text-align: center;
        }

        .table-body tr {
            transition: all 0.3s ease;
            cursor: pointer;
            border-bottom: 1px solid var(--border-secondary);
        }

        .table-body tr:hover {
            background: rgba(34, 211, 238, 0.1);
            box-shadow: 0 0 15px rgba(34, 211, 238, 0.2);
        }

        .table-body tr.selected {
            background: rgba(34, 211, 238, 0.15);
            box-shadow: 0 0 20px rgba(34, 211, 238, 0.3);
            border-left: 4px solid var(--accent-primary);
        }

        .table-body td {
            padding: 1.2rem 1rem;
            font-size: 0.875rem;
            border-right: 1px solid var(--border-secondary);
            color: var(--text-primary);
            vertical-align: middle;
        }

        .table-body td:last-child {
            text-align: center;
            padding: 0.8rem;
        }

        /* Status Colors */
        .status-pending { background-color: rgba(156, 163, 175, 0.2) !important; }
        .status-approved { background-color: rgba(245, 158, 11, 0.2) !important; }
        .status-priced { background-color: rgba(59, 130, 246, 0.2) !important; }
        .status-paid { background-color: rgba(34, 197, 94, 0.2) !important; }
        .status-rejected { background-color: rgba(239, 68, 68, 0.2) !important; }

        .status-badge {
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
            text-align: center;
            white-space: nowrap;
        }

        .status-pending .status-badge { background: #6B7280; color: white; }
        .status-approved .status-badge { background: #F59E0B; color: white; }
        .status-priced .status-badge { background: #3B82F6; color: white; }
        .status-paid .status-badge { background: #22C55E; color: white; }
        .status-rejected .status-badge { background: #EF4444; color: white; }

        /* Corporate Smart Action Panel */
        .smart-panel {
            position: fixed;
            bottom: 0;
            left: var(--sidebar-width);
            right: 350px;
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border-top: 3px solid var(--accent-primary);
            padding: 1.5rem 2rem;
            transform: translateY(100%);
            transition: all 0.4s ease;
            z-index: 50;
            box-shadow: 0 -8px 32px rgba(34, 211, 238, 0.2);
        }

        .smart-panel.active {
            transform: translateY(0);
        }

        .smart-panel::before {
            content: '';
            position: absolute;
            top: -3px;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, #22D3EE, #38BDF8, #22D3EE);
            box-shadow: 0 0 15px rgba(34, 211, 238, 0.5);
        }

        .panel-content {
            display: flex;
            align-items: center;
            justify-content: space-between;
            max-width: 1200px;
            margin: 0 auto;
        }

        .panel-info {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .panel-info-text {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        .panel-info-request {
            font-size: 1rem;
            font-weight: 600;
            color: var(--accent-primary);
        }

        .panel-actions {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .panel-btn {
            padding: 0.8rem 1.5rem;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            font-size: 0.875rem;
            transition: all 0.3s ease;
            border: 2px solid;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .panel-btn.approve {
            background: rgba(34, 197, 94, 0.15);
            border-color: #22C55E;
            color: #22C55E;
        }

        .panel-btn.reject {
            background: rgba(239, 68, 68, 0.15);
            border-color: #EF4444;
            color: #EF4444;
        }

        .panel-btn.price {
            background: rgba(245, 158, 11, 0.15);
            border-color: #F59E0B;
            color: #F59E0B;
        }

        .panel-btn.payment {
            background: rgba(34, 197, 94, 0.15);
            border-color: #22C55E;
            color: #22C55E;
        }

        .panel-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
            filter: brightness(1.1);
        }

        /* Right Side Panel - Activity Log */
        .activity-panel {
            position: fixed;
            top: 0;
            right: 0;
            width: 350px;
            height: 100vh;
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border-left: 2px solid var(--border-primary);
            transform: translateX(100%);
            transition: all 0.4s ease;
            z-index: 90;
            box-shadow: -4px 0 15px rgba(0, 0, 0, 0.1);
        }

        .activity-panel.active {
            transform: translateX(0);
        }

        .activity-header {
            padding: 1.5rem;
            border-bottom: 2px solid var(--border-primary);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .activity-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .activity-close {
            width: 32px;
            height: 32px;
            border-radius: 8px;
            background: rgba(239, 68, 68, 0.2);
            border: 2px solid #EF4444;
            color: #EF4444;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .activity-close:hover {
            background: rgba(239, 68, 68, 0.3);
        }

        .activity-content {
            flex: 1;
            padding: 1rem;
            overflow-y: auto;
        }

        .activity-entry {
            padding: 1rem;
            margin-bottom: 0.5rem;
            background: rgba(34, 211, 238, 0.05);
            border: 1px solid rgba(34, 211, 238, 0.2);
            border-radius: 8px;
            font-size: 0.85rem;
            transition: all 0.3s ease;
        }

        .activity-entry:hover {
            background: rgba(34, 211, 238, 0.1);
        }

        .activity-time {
            color: var(--accent-primary);
            font-weight: 600;
            font-size: 0.8rem;
        }

        .activity-message {
            color: var(--text-secondary);
            margin-top: 0.25rem;
        }

        .activity-toggle {
            position: fixed;
            top: 50%;
            right: 0;
            transform: translateY(-50%);
            background: var(--accent-primary);
            color: white;
            border: none;
            padding: 1rem 0.5rem;
            border-radius: 8px 0 0 8px;
            cursor: pointer;
            font-size: 1.2rem;
            z-index: 100;
            transition: all 0.3s ease;
            box-shadow: -4px 0 15px rgba(34, 211, 238, 0.3);
        }

        .activity-toggle:hover {
            background: var(--accent-secondary);
            transform: translateY(-50%) translateX(-5px);
        }

        /* PDF Modal */
        .pdf-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(8px);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            padding: 2rem;
        }

        .pdf-modal.active {
            display: flex;
        }

        .pdf-container {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border: 2px solid var(--border-primary);
            border-radius: 20px;
            width: 90%;
            max-width: 900px;
            height: 80%;
            display: flex;
            flex-direction: column;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }

        .pdf-header {
            padding: 1.5rem;
            border-bottom: 2px solid var(--border-primary);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .pdf-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--text-primary);
        }

        .pdf-close {
            width: 40px;
            height: 40px;
            border-radius: 8px;
            background: rgba(239, 68, 68, 0.2);
            border: 2px solid #EF4444;
            color: #EF4444;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            transition: all 0.3s ease;
        }

        .pdf-close:hover {
            background: rgba(239, 68, 68, 0.3);
        }

        .pdf-viewer {
            flex: 1;
            padding: 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #f5f5f5;
            border-radius: 0 0 18px 18px;
        }

        .pdf-iframe {
            width: 100%;
            height: 100%;
            border: none;
            border-radius: 8px;
        }

        .pdf-footer {
            padding: 1rem 1.5rem;
            border-top: 2px solid var(--border-secondary);
            display: flex;
            justify-content: center;
        }

        /* Toast Notifications */
        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--glass-bg);
            backdrop-filter: blur(16px);
            border: 2px solid var(--border-primary);
            border-radius: 12px;
            padding: 1rem 1.5rem;
            color: var(--text-primary);
            font-weight: 600;
            z-index: 3000;
            transform: translateX(400px);
            transition: all 0.4s ease;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
            max-width: 400px;
        }

        .toast.active {
            transform: translateX(0);
        }

        .toast.success {
            border-color: #22C55E;
            color: #22C55E;
        }

        .toast.error {
            border-color: #EF4444;
            color: #EF4444;
        }

        .toast.warning {
            border-color: #F59E0B;
            color: #F59E0B;
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
            .sidebar {
                transform: translateX(-100%);
                z-index: 200;
            }

            .sidebar.mobile-open {
                transform: translateX(0);
            }

            .main-content {
                margin-left: 0;
            }

            .smart-panel {
                left: 0;
                right: 0;
            }

            .activity-panel {
                width: 100%;
            }

            .activity-toggle {
                right: 10px;
            }

            .top-bar {
                padding: 1rem;
                flex-direction: column;
                gap: 1rem;
            }

            .top-left {
                justify-content: center;
            }

            .system-title {
                font-size: 1.1rem;
            }

            .page-title-center {
                font-size: 1rem;
            }

            .content-area {
                padding: 1rem;
            }

            .central-table-container {
                max-width: 100%;
            }

            .action-bar {
                flex-direction: column;
                align-items: stretch;
            }

            .filters-grid {
                grid-template-columns: 1fr;
            }

            .data-table {
                min-width: 900px;
            }

            .pdf-container {
                width: 95%;
                height: 90%;
                margin: 1rem;
            }

            .panel-content {
                flex-direction: column;
                gap: 1rem;
            }

            .panel-actions {
                width: 100%;
                justify-content: center;
                flex-wrap: wrap;
            }

            .top-logo {
                width: 40px;
                height: 40px;
            }
        }

        /* Report Forms Styles */
        .page-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 1.5rem;
            padding: 1rem 0;
        }

        .page-title {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--text-primary);
            background: var(--role-gradient, var(--accent-gradient));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin: 0;
        }

        .report-filters {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border: 2px solid var(--border-primary);
            border-radius: 16px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .report-row {
            transition: all 0.3s ease;
            cursor: pointer;
            border-bottom: 1px solid var(--border-secondary);
        }

        .report-row:hover {
            background: var(--border-primary);
            box-shadow: 0 0 15px var(--accent-primary);
        }

        .report-actions {
            display: flex;
            gap: 0.5rem;
            align-items: center;
        }

        .action-btn {
            padding: 0.5rem 1rem;
            border-radius: 8px;
            border: none;
            cursor: pointer;
            font-weight: 600;
            font-size: 0.75rem;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        .action-btn.view {
            background: rgba(59, 130, 246, 0.2);
            border: 2px solid #3B82F6;
            color: #3B82F6;
        }

        .action-btn.download {
            background: rgba(34, 197, 94, 0.2);
            border: 2px solid #22C55E;
            color: #22C55E;
        }

        .action-btn.approve {
            background: rgba(34, 197, 94, 0.2);
            border: 2px solid #22C55E;
            color: #22C55E;
        }

        .action-btn.reject {
            background: rgba(239, 68, 68, 0.2);
            border: 2px solid #EF4444;
            color: #EF4444;
        }

        .action-btn.price {
            background: rgba(245, 158, 11, 0.2);
            border: 2px solid #F59E0B;
            color: #F59E0B;
        }

        .action-btn.payment {
            background: rgba(34, 197, 94, 0.2);
            border: 2px solid #22C55E;
            color: #22C55E;
        }

        .action-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            filter: brightness(1.1);
        }

        .action-buttons {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
        }

        /* Row Animation */
        .row-highlight {
            animation: highlightRow 1s ease-in-out;
        }

        @keyframes highlightRow {
            0% { box-shadow: 0 0 0 rgba(34, 211, 238, 0); }
            50% { box-shadow: 0 0 20px rgba(34, 211, 238, 0.8); }
            100% { box-shadow: 0 0 0 rgba(34, 211, 238, 0); }
        }

        /* Log Panel */
        .log-panel {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 350px;
            max-height: 300px;
            background: var(--glass-bg);
            backdrop-filter: blur(16px);
            border: 2px solid var(--border-primary);
            border-radius: 12px;
            padding: 1rem;
            z-index: 1000;
            transform: translateX(400px);
            transition: all 0.4s ease;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
        }

        .log-panel.active {
            transform: translateX(0);
        }

        .log-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 1px solid var(--border-secondary);
        }

        .log-title {
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--text-primary);
        }

        .log-close {
            width: 24px;
            height: 24px;
            border-radius: 4px;
            background: rgba(239, 68, 68, 0.2);
            border: 1px solid #EF4444;
            color: #EF4444;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
        }

        .log-entries {
            max-height: 200px;
            overflow-y: auto;
        }

        .log-entry {
            padding: 0.5rem 0;
            border-bottom: 1px solid var(--border-secondary);
            font-size: 0.8rem;
            color: var(--text-secondary);
        }

        .log-entry:last-child {
            border-bottom: none;
        }

        .log-time {
            color: var(--accent-primary);
            font-weight: 600;
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg-secondary);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb {
            background: var(--accent-primary);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--accent-secondary);
        }

        /* Loading Screen */
        .loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: #0F1115;
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 3000;
            transition: all 0.5s ease;
            flex-direction: column;
        }

        .loading-screen.active {
            display: flex;
        }

        .loading-container {
            text-align: center;
            background: rgba(21, 25, 34, 0.95);
            backdrop-filter: blur(12px);
            border: 2px solid rgba(34, 211, 238, 0.3);
            border-radius: 18px;
            padding: 3rem;
            box-shadow: 0 8px 32px rgba(34, 211, 238, 0.3);
            position: relative;
        }

        .loading-logo-wrapper {
            position: relative;
            display: inline-block;
            margin-bottom: 2rem;
        }

        .loading-logo {
            width: 120px;
            height: 120px;
            border-radius: 16px;
            object-fit: contain;
            position: relative;
            filter: drop-shadow(0 0 15px rgba(34, 211, 238, 0.4));
            animation: logo-glow 1.5s ease-out 1s forwards;
        }

        .loading-ring {
            position: absolute;
            top: -20px;
            left: -20px;
            width: 160px;
            height: 160px;
            border: 3px solid transparent;
            border-top: 3px solid #22D3EE;
            border-radius: 50%;
            animation: spin 1s linear forwards;
            opacity: 0.8;
        }

        .loading-text {
            font-size: 1.1rem;
            color: #22D3EE;
            font-weight: 500;
            animation: fade-pulse 1.5s ease-in-out infinite;
            margin-bottom: 0;
        }

        .corporate-signature {
            position: absolute;
            bottom: 2rem;
            left: 50%;
            transform: translateX(-50%);
            text-align: center;
            opacity: 0;
            animation: signature-appear 1s ease-out 1.8s forwards;
        }

        .signature-text {
            font-family: 'Inter', 'Roboto Mono', monospace;
            font-style: italic;
            font-size: 0.9rem;
            color: #22D3EE;
            letter-spacing: 1.2px;
            margin: 0;
            position: relative;
            overflow: hidden;
            white-space: nowrap;
        }

        .signature-text::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: #0F1115;
            animation: signature-draw 1s ease-out 1.8s forwards;
        }

        .signature-gear {
            display: inline-block;
            margin-left: 0.5rem;
            animation: gear-rotate 1.5s ease-out 2.5s forwards;
        }

        .signature-line {
            width: 100%;
            height: 1px;
            background: linear-gradient(90deg, transparent, #22D3EE, transparent);
            opacity: 0.5;
            margin-top: 0.5rem;
            animation: line-glow 0.5s ease-out 2.8s forwards;
        }

        .bilingual-slogan {
            margin-top: 8px;
            position: relative;
            height: 3rem;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .slogan-container {
            position: relative;
            height: 1.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 0.5rem;
        }

        .slogan-text {
            font-family: 'Inter', 'Roboto Mono', monospace;
            font-weight: 300;
            font-style: italic;
            font-size: 0.75rem;
            color: #A1A1AA;
            letter-spacing: 0.8px;
            position: absolute;
            opacity: 0;
            white-space: nowrap;
            text-align: center;
        }

        .slogan-english {
            animation: slogan-fade-english 2s ease-in-out 3.5s forwards;
        }

        .slogan-turkish {
            animation: slogan-fade-turkish 2s ease-in-out 5.5s forwards;
        }

        .globe-icon {
            font-size: 1rem;
            opacity: 0;
            transform: rotate(0deg);
            filter: drop-shadow(0 0 8px rgba(34, 211, 238, 0.6));
            animation: globe-transition 1s ease-in-out 5.5s forwards;
        }

        .light-trail {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: radial-gradient(circle at center, rgba(34, 211, 238, 0.1) 0%, transparent 70%);
            opacity: 0;
            animation: light-trail-effect 0.8s ease-out 3.2s forwards;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @keyframes logo-glow {
            0% { 
                filter: drop-shadow(0 0 15px rgba(34, 211, 238, 0.4));
            }
            50% { 
                filter: drop-shadow(0 0 30px rgba(34, 211, 238, 0.8)) drop-shadow(0 0 50px rgba(34, 211, 238, 0.6));
            }
            100% { 
                filter: drop-shadow(0 0 20px rgba(34, 211, 238, 0.5));
            }
        }

        @keyframes fade-pulse {
            0%, 100% { opacity: 0.6; }
            50% { opacity: 1; }
        }

        @keyframes signature-appear {
            0% { 
                opacity: 0;
                transform: translateX(-50%) translateY(20px);
            }
            100% { 
                opacity: 1;
                transform: translateX(-50%) translateY(0);
            }
        }

        @keyframes signature-draw {
            0% { 
                right: 0;
            }
            100% { 
                right: 100%;
            }
        }

        @keyframes gear-rotate {
            0% { 
                transform: rotate(0deg);
            }
            100% { 
                transform: rotate(360deg);
            }
        }

        @keyframes line-glow {
            0% { 
                opacity: 0.5;
                box-shadow: 0 0 5px rgba(34, 211, 238, 0.3);
            }
            50% { 
                opacity: 1;
                box-shadow: 0 0 15px rgba(34, 211, 238, 0.6);
            }
            100% { 
                opacity: 0.9;
                box-shadow: 0 0 10px rgba(34, 211, 238, 0.4);
            }
        }

        @keyframes light-trail-effect {
            0% { 
                opacity: 0;
                transform: scale(0.8);
            }
            50% { 
                opacity: 0.3;
                transform: scale(1.2);
            }
            100% { 
                opacity: 0;
                transform: scale(2);
            }
        }

        @keyframes slogan-fade-english {
            0% { 
                opacity: 0;
                transform: translateY(10px);
            }
            20% { 
                opacity: 1;
                transform: translateY(0);
            }
            80% { 
                opacity: 1;
                transform: translateY(0);
            }
            100% { 
                opacity: 0;
                transform: translateY(-10px);
            }
        }

        @keyframes slogan-fade-turkish {
            0% { 
                opacity: 0;
                transform: translateY(10px);
            }
            20% { 
                opacity: 1;
                transform: translateY(0);
            }
            80% { 
                opacity: 1;
                transform: translateY(0);
            }
            100% { 
                opacity: 0;
                transform: translateY(-10px);
            }
        }

        @keyframes globe-transition {
            0% { 
                opacity: 0;
                transform: rotate(0deg) scale(0.8);
                filter: drop-shadow(0 0 8px rgba(34, 211, 238, 0.6));
            }
            50% { 
                opacity: 1;
                transform: rotate(180deg) scale(1.1);
                filter: drop-shadow(0 0 15px rgba(34, 211, 238, 0.9));
            }
            100% { 
                opacity: 1;
                transform: rotate(360deg) scale(1);
                filter: drop-shadow(0 0 10px rgba(34, 211, 238, 0.7));
            }
        }

        @keyframes screen-fadeout {
            0% { 
                opacity: 1;
                transform: scale(1);
            }
            80% { 
                opacity: 0.3;
                transform: scale(1.05);
            }
            100% { 
                opacity: 0;
                transform: scale(1.1);
            }
        }

        /* Login Error */
        .login-error {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--glass-bg);
            backdrop-filter: blur(16px);
            border: 2px solid #EF4444;
            color: #EF4444;
            padding: 1rem 1.5rem;
            border-radius: 12px;
            font-weight: 600;
            font-size: 0.9rem;
            z-index: 2001;
            box-shadow: 0 4px 20px rgba(239, 68, 68, 0.3);
            opacity: 0;
            transform: translateY(-10px);
            transition: all 0.3s ease;
            max-width: 300px;
        }

        .login-error.active {
            opacity: 1;
            transform: translateY(0);
        }

        /* Form Modal */
        .form-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(8px);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            padding: 2rem;
        }

        .form-modal.active {
            display: flex;
        }

        .modal-content {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border: 2px solid var(--border-primary);
            border-radius: 20px;
            width: 90%;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }

        .modal-header {
            padding: 1.5rem;
            border-bottom: 2px solid var(--border-primary);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .modal-title {
            font-size: 1.3rem;
            font-weight: 600;
            color: var(--text-primary);
        }

        .modal-close {
            width: 40px;
            height: 40px;
            border-radius: 8px;
            background: rgba(239, 68, 68, 0.2);
            border: 2px solid #EF4444;
            color: #EF4444;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            transition: all 0.3s ease;
        }

        .modal-close:hover {
            background: rgba(239, 68, 68, 0.3);
        }

        .modal-body {
            padding: 1.5rem;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-label {
            display: block;
            font-size: 0.875rem;
            color: var(--text-secondary);
            font-weight: 500;
            margin-bottom: 0.5rem;
        }

        .form-input, .form-textarea, .form-select {
            width: 100%;
            background: var(--bg-secondary);
            border: 2px solid var(--border-secondary);
            color: var(--text-primary);
            padding: 0.75rem;
            border-radius: 8px;
            font-size: 0.875rem;
            transition: all 0.4s ease;
            font-family: 'Inter', sans-serif;
        }

        .form-textarea {
            resize: vertical;
            min-height: 100px;
        }

        .form-input:focus, .form-textarea:focus, .form-select:focus {
            outline: none;
            border-color: var(--accent-primary);
            box-shadow: 0 0 15px var(--border-primary);
        }

        .modal-footer {
            padding: 1rem 1.5rem;
            border-top: 2px solid var(--border-secondary);
            display: flex;
            gap: 1rem;
            justify-content: flex-end;
        }

        .modal-btn {
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            font-size: 0.875rem;
            transition: all 0.3s ease;
            border: none;
        }

        .modal-btn.primary {
            background: var(--accent-gradient);
            color: white;
            box-shadow: 0 4px 15px rgba(34, 211, 238, 0.3);
        }

        .modal-btn.primary:hover {
            transform: translateY(-1px);
            box-shadow: 0 6px 20px rgba(34, 211, 238, 0.4);
        }

        .modal-btn.secondary {
            background: var(--bg-secondary);
            border: 2px solid var(--border-secondary);
            color: var(--text-primary);
        }

        .modal-btn.secondary:hover {
            background: var(--border-primary);
            border-color: var(--accent-primary);
            color: var(--accent-primary);
        }
    </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
  <script src="https://cdn.tailwindcss.com" type="text/javascript"></script>
 </head>
 <body><!-- Login Screen -->
  <div class="login-screen" id="loginScreen">
   <div class="login-container"><img src="https://i.hizliresim.com/ot1wnpw.png" alt="SOMTECH Logo" class="login-logo" onclick="window.open('https://www.somtech.ru', '_blank')" onerror="this.src=''; this.alt='Logo failed to load'; this.style.display='none';">
    <h1 class="login-title" id="loginTitle">SOMTECH Satın Alma Sistemine Hoş Geldiniz</h1>
    <p class="login-subtitle" id="loginSubtitle">Lütfen kullanıcı bilgilerinizi girerek sisteme giriş yapınız.</p>
    <form class="login-form" id="loginForm">
     <div class="login-input-group"><label class="login-label" id="usernameLabel">Kullanıcı Adı</label> <input type="text" class="login-input" id="usernameInput" placeholder="Kullanıcı adınızı girin">
     </div>
     <div class="login-input-group"><label class="login-label" id="passwordLabel">Şifre</label> <input type="password" class="login-input" id="passwordInput" placeholder="Şifrenizi girin">
     </div><button type="submit" class="login-button" id="loginButton">Giriş Yap</button>
    </form>
    <div class="login-controls"><button class="login-control-btn" id="loginThemeBtn" onclick="toggleTheme()"> <span id="loginThemeIcon">🌙</span> </button> <button class="login-control-btn" id="loginLanguageBtn" onclick="toggleLoginLanguageDropdown()"> <span id="currentLanguageFlag">🇹🇷</span> </button>
     <div class="dropdown" id="loginLanguageDropdown">
      <div class="dropdown-item active" data-lang="tr" onclick="changeLanguage('tr')"><span>🇹🇷</span> <span>Türkçe</span>
      </div>
      <div class="dropdown-item" data-lang="en" onclick="changeLanguage('en')"><span>🇬🇧</span> <span>English</span>
      </div>
      <div class="dropdown-item" data-lang="ru" onclick="changeLanguage('ru')"><span>🇷🇺</span> <span>Русский</span>
      </div>
     </div>
    </div>
   </div>
  </div><!-- Loading Screen -->
  <div class="loading-screen" id="loadingScreen">
   <div class="loading-container">
    <div class="loading-logo-wrapper"><img src="https://i.hizliresim.com/ot1wnpw.png" alt="SOMTECH Logo" class="loading-logo" onerror="this.src=''; this.alt='Logo failed to load'; this.style.display='none';">
     <div class="loading-ring"></div>
    </div>
    <div class="loading-text">
     Sisteme bağlanıyor...
    </div>
    <div class="corporate-signature">
     <p class="signature-text">System engineered with precision by Karslio<span class="signature-gear">⚙️</span></p>
     <div class="signature-line"></div>
     <div class="bilingual-slogan">
      <div class="slogan-container">
       <div class="slogan-text slogan-english">
        Designed for precision, built for performance.
       </div>
       <div class="slogan-text slogan-turkish">
        Mükemmeliyet için tasarlandı, performans için üretildi.
       </div>
      </div>
      <div class="globe-icon">
       🌐
      </div>
     </div>
    </div>
   </div>
   <div class="light-trail"></div>
  </div><!-- Login Error -->
  <div class="login-error" id="loginError">
   Kullanıcı adı veya şifre hatalı.
  </div><!-- Main Application -->
  <div class="app-container" id="appContainer"><!-- Sidebar -->
   <div class="sidebar" id="sidebar">
    <div class="sidebar-header"><img src="https://i.hizliresim.com/ot1wnpw.png" alt="SOMTECH Logo" class="sidebar-logo" onerror="this.src=''; this.alt='Logo failed to load'; this.style.display='none';">
     <h2 class="sidebar-title">SOMTECH ERP</h2>
    </div>
    <div class="sidebar-menu">
     <div class="menu-item active" data-module="dashboard"><span class="menu-icon">📊</span> <span class="menu-text" id="menuDashboard">Ana Panel</span>
     </div>
     <div class="menu-item" data-module="requests"><span class="menu-icon">📝</span> <span class="menu-text" id="menuRequests">Talepler</span>
     </div>
     <div class="menu-item" data-module="approvals"><span class="menu-icon">✅</span> <span class="menu-text" id="menuApprovals">Onaylar</span>
     </div>
     <div class="menu-item" data-module="procurement"><span class="menu-icon">💰</span> <span class="menu-text" id="menuProcurement">Satın Alma</span>
     </div>
     <div class="menu-item" data-module="accounting"><span class="menu-icon">🧾</span> <span class="menu-text" id="menuAccounting">Muhasebe</span>
     </div>
     <div class="menu-item" data-module="reports"><span class="menu-icon">📈</span> <span class="menu-text" id="menuReports">Raporlar</span>
     </div>
     <div class="menu-item" data-module="report-forms"><span class="menu-icon">📄</span> <span class="menu-text" id="menuReportForms">Rapor Formu</span>
     </div>
     <div class="menu-item" data-module="settings"><span class="menu-icon">⚙️</span> <span class="menu-text" id="menuSettings">Ayarlar</span>
     </div>
    </div>
    <div class="sidebar-footer"><button class="logout-btn" onclick="logout()"> <span>🚪</span> <span id="logoutText">Çıkış Yap</span> </button>
    </div>
   </div><!-- Main Content -->
   <div class="main-content"><!-- Corporate Top Bar -->
    <div class="top-bar">
     <div class="top-left"><img src="https://i.hizliresim.com/ot1wnpw.png" alt="SOMTECH Logo" class="top-logo" onerror="this.src=''; this.alt='Logo failed to load'; this.style.display='none';">
      <h1 class="system-title" id="systemTitle">SOMTECH SOF ERP v9.2.0</h1>
     </div>
     <div class="page-title-center" id="pageTitleCenter">
      Talepler
     </div>
     <div class="top-controls"><button class="control-btn" id="languageBtn" onclick="toggleLanguageDropdown()"> <span>🌐</span>
       <div class="dropdown" id="languageDropdown">
        <div class="dropdown-item active" data-lang="tr" onclick="changeLanguage('tr')"><span>🇹🇷</span> <span>Türkçe</span>
        </div>
        <div class="dropdown-item" data-lang="en" onclick="changeLanguage('en')"><span>🇬🇧</span> <span>English</span>
        </div>
        <div class="dropdown-item" data-lang="ru" onclick="changeLanguage('ru')"><span>🇷🇺</span> <span>Русский</span>
        </div>
       </div></button> <button class="control-btn" id="themeBtn" onclick="toggleTheme()"> <span id="themeIcon">🌙</span> </button> <button class="control-btn user-menu-btn" id="userMenuBtn" onclick="toggleUserMenu()"> <span>👤</span> <span id="userMenuText">Kullanıcı</span>
       <div class="dropdown" id="userDropdown">
        <div class="dropdown-item" onclick="openProfile()"><span>👤</span> <span id="profileText">Profil</span>
        </div>
        <div class="dropdown-item" onclick="openSettings()"><span>⚙️</span> <span id="settingsText">Ayarlar</span>
        </div>
        <div class="dropdown-item" onclick="logout()"><span>🚪</span> <span id="logoutMenuText">Çıkış</span>
        </div>
       </div></button>
     </div>
    </div><!-- Content Area -->
    <div class="content-area">
     <div class="central-table-container"><!-- Action Bar -->
      <div class="action-bar">
       <div class="action-left"><button class="primary-btn" id="newRequestBtn" onclick="openNewRequestModal()" style="display: none;"> <span>➕</span> <span id="newRequestText">Yeni Talep</span> </button>
       </div>
       <div class="action-right"><button class="secondary-btn" onclick="exportData()"> <span>📤</span> <span id="exportText">Dışa Aktar</span> </button> <button class="secondary-btn" onclick="toggleActivityPanel()"> <span>📋</span> <span id="activityText">İşlem Günlüğü</span> </button>
       </div>
      </div><!-- Filters -->
      <div class="filters-section">
       <div class="filters-grid">
        <div class="filter-group"><label class="filter-label" id="searchLabel">Arama</label> <input type="text" class="filter-input" id="searchInput" placeholder="Talep numarası, açıklama...">
        </div>
        <div class="filter-group"><label class="filter-label" id="statusLabel">Durum</label> <select class="filter-select" id="statusFilter"> <option value="">Tümü</option> <option value="pending">Bekliyor</option> <option value="approved">Onaylandı</option> <option value="priced">Fiyatlandı</option> <option value="paid">Ödendi</option> <option value="rejected">Reddedildi</option> </select>
        </div>
        <div class="filter-group"><label class="filter-label" id="dateLabel">Tarih</label> <input type="date" class="filter-input" id="dateFilter">
        </div>
        <div class="filter-group"><button class="secondary-btn" onclick="resetFilters()"> <span>🔄</span> <span id="resetText">Sıfırla</span> </button>
        </div>
       </div>
      </div><!-- Central Requests Table -->
      <div class="table-container" id="requestsTable">
       <div class="table-wrapper">
        <table class="data-table">
         <thead class="table-header">
          <tr>
           <th id="thRequestNo">Talep No</th>
           <th id="thDate">Tarih</th>
           <th id="thRequester">Talep Eden</th>
           <th id="thDescription">Açıklama</th>
           <th id="thAmount">Tutar</th>
           <th id="thStatus">Durum</th>
           <th id="thActions">İşlemler</th>
          </tr>
         </thead>
         <tbody class="table-body" id="tableBody"><!-- Sample Data -->
          <tr class="status-pending" data-id="1" data-request-no="RF100.SOFS-0001" onclick="selectRow(this)">
           <td>RF100.SOFS-0001</td>
           <td>15.01.2024</td>
           <td>Ahmet Yılmaz</td>
           <td>Ofis malzemeleri satın alımı - Kırtasiye, dosya, kalem vb.</td>
           <td>2,500.00 ₺</td>
           <td><span class="status-badge">Bekliyor</span></td>
           <td class="action-buttons"><button class="action-btn approve" onclick="approveRequestInline(this)" style="display: none;">✅ Onayla</button> <button class="action-btn reject" onclick="rejectRequestInline(this)" style="display: none;">❌ Reddet</button> <button class="action-btn price" onclick="setPriceInline(this)" style="display: none;">💰 Fiyat Gir</button> <button class="action-btn payment" onclick="markAsPaidInline(this)" style="display: none;">💳 Ödeme Yapıldı</button></td>
          </tr>
          <tr class="status-approved" data-id="2" data-request-no="RF100.SOFS-0002" onclick="selectRow(this)">
           <td>RF100.SOFS-0002</td>
           <td>14.01.2024</td>
           <td>Mehmet Demir</td>
           <td>Bilgisayar donanımı - Laptop, monitör, klavye</td>
           <td>15,000.00 ₺</td>
           <td><span class="status-badge">Onaylandı</span></td>
           <td class="action-buttons"><button class="action-btn approve" onclick="approveRequestInline(this)" style="display: none;">✅ Onayla</button> <button class="action-btn reject" onclick="rejectRequestInline(this)" style="display: none;">❌ Reddet</button> <button class="action-btn price" onclick="setPriceInline(this)" style="display: none;">💰 Fiyat Gir</button> <button class="action-btn payment" onclick="markAsPaidInline(this)" style="display: none;">💳 Ödeme Yapıldı</button></td>
          </tr>
          <tr class="status-priced" data-id="3" data-request-no="RF100.SOFS-0003" onclick="selectRow(this)">
           <td>RF100.SOFS-0003</td>
           <td>13.01.2024</td>
           <td>Fatma Özkan</td>
           <td>Yazılım lisansları - Office 365, Adobe Creative Suite</td>
           <td>8,750.00 ₺</td>
           <td><span class="status-badge">Fiyatlandı</span></td>
           <td class="action-buttons"><button class="action-btn approve" onclick="approveRequestInline(this)" style="display: none;">✅ Onayla</button> <button class="action-btn reject" onclick="rejectRequestInline(this)" style="display: none;">❌ Reddet</button> <button class="action-btn price" onclick="setPriceInline(this)" style="display: none;">💰 Fiyat Gir</button> <button class="action-btn payment" onclick="markAsPaidInline(this)" style="display: none;">💳 Ödeme Yapıldı</button></td>
          </tr>
          <tr class="status-paid" data-id="4" data-request-no="RF100.SOFS-0004" onclick="selectRow(this)">
           <td>RF100.SOFS-0004</td>
           <td>12.01.2024</td>
           <td>Ali Kaya</td>
           <td>Temizlik malzemeleri - Deterjan, kağıt havlu, çöp poşeti</td>
           <td>1,200.00 ₺</td>
           <td><span class="status-badge">Ödendi</span></td>
           <td class="action-buttons"><button class="action-btn approve" onclick="approveRequestInline(this)" style="display: none;">✅ Onayla</button> <button class="action-btn reject" onclick="rejectRequestInline(this)" style="display: none;">❌ Reddet</button> <button class="action-btn price" onclick="setPriceInline(this)" style="display: none;">💰 Fiyat Gir</button> <button class="action-btn payment" onclick="markAsPaidInline(this)" style="display: none;">💳 Ödeme Yapıldı</button></td>
          </tr>
          <tr class="status-rejected" data-id="5" data-request-no="RF100.SOFS-0005" onclick="selectRow(this)">
           <td>RF100.SOFS-0005</td>
           <td>11.01.2024</td>
           <td>Zeynep Kara</td>
           <td>Mobilya alımı - Ofis masası, sandalye, dolap</td>
           <td>25,000.00 ₺</td>
           <td><span class="status-badge">Reddedildi</span></td>
           <td class="action-buttons"><button class="action-btn approve" onclick="approveRequestInline(this)" style="display: none;">✅ Onayla</button> <button class="action-btn reject" onclick="rejectRequestInline(this)" style="display: none;">❌ Reddet</button> <button class="action-btn price" onclick="setPriceInline(this)" style="display: none;">💰 Fiyat Gir</button> <button class="action-btn payment" onclick="markAsPaidInline(this)" style="display: none;">💳 Ödeme Yapıldı</button></td>
          </tr>
         </tbody>
        </table>
       </div>
      </div><!-- Report Forms Table -->
      <div class="table-container" id="reportFormsTable" style="display: none;">
       <div class="page-header">
        <h2 class="page-title">📄 Rapor Formları</h2><button class="primary-btn" onclick="openUploadReportModal()"> <span>➕</span> <span id="addReportText">Yeni Rapor Ekle</span> </button>
       </div>
       <div class="report-filters">
        <div class="filter-group"><label class="filter-label">Arama</label> <input type="text" class="filter-input" id="reportSearchInput" placeholder="Rapor adı, talep numarası...">
        </div>
        <div class="filter-group"><label class="filter-label">Sıralama</label> <select class="filter-select" id="reportSortFilter"> <option value="date">Tarihe Göre</option> <option value="name">Rapor Adına Göre</option> <option value="user">Kullanıcıya Göre</option> </select>
        </div>
       </div>
       <div class="table-wrapper" style="max-height: 75vh;">
        <table class="data-table">
         <thead class="table-header">
          <tr>
           <th>Rapor Adı</th>
           <th>İlgili Talep No</th>
           <th>Yükleyen Kullanıcı</th>
           <th>Tarih</th>
           <th>İşlem</th>
          </tr>
         </thead>
         <tbody class="table-body" id="reportTableBody"><!-- Sample Report Data -->
          <tr class="report-row" onclick="selectReportRow(this)">
           <td>Sipariş Onay Formu – RF100.SOFS-0004</td>
           <td>RF100.SOFS-0004</td>
           <td>Ali Kaya</td>
           <td>12.01.2024</td>
           <td class="report-actions"><button class="action-btn view" onclick="viewReportPdf('RF100.SOFS-0004_SOF_RAPOR.pdf', 'RF100.SOFS-0004')">📄 Görüntüle</button> <button class="action-btn download" onclick="downloadReportPdf('RF100.SOFS-0004_SOF_RAPOR.pdf')" style="display: none;">📥 İndir</button> <button class="action-btn reject" onclick="deleteReport(this)" style="display: none;">🗑️ Sil</button></td>
          </tr>
          <tr class="report-row" onclick="selectReportRow(this)">
           <td>Fiyat Onay Belgesi – RF100.SOFS-0003</td>
           <td>RF100.SOFS-0003</td>
           <td>Fatma Özkan</td>
           <td>13.01.2024</td>
           <td class="report-actions"><button class="action-btn view" onclick="viewReportPdf('RF100.SOFS-0003_SOF_RAPOR.pdf', 'RF100.SOFS-0003')">📄 Görüntüle</button> <button class="action-btn download" onclick="downloadReportPdf('RF100.SOFS-0003_SOF_RAPOR.pdf')" style="display: none;">📥 İndir</button> <button class="action-btn reject" onclick="deleteReport(this)" style="display: none;">🗑️ Sil</button></td>
          </tr>
         </tbody>
        </table>
       </div>
      </div>
     </div>
    </div>
   </div><!-- Corporate Smart Action Panel -->
   <div class="smart-panel" id="smartPanel">
    <div class="panel-content">
     <div class="panel-info"><span class="panel-info-text">Seçili Talep:</span> <span class="panel-info-request" id="selectedRequest">-</span>
     </div>
     <div class="panel-actions" id="panelActions"><!-- Actions will be populated based on user role and request status -->
     </div>
    </div>
   </div><!-- Activity Panel -->
   <div class="activity-panel" id="activityPanel">
    <div class="activity-header">
     <div class="activity-title">
      📋 İşlem Günlüğü
     </div><button class="activity-close" onclick="toggleActivityPanel()">✕</button>
    </div>
    <div class="activity-content" id="activityContent"><!-- Activity entries will be populated here -->
    </div>
   </div><!-- Activity Toggle Button --> <button class="activity-toggle" id="activityToggle" onclick="toggleActivityPanel()"> 📋 </button>
  </div><!-- PDF Modal -->
  <div class="pdf-modal" id="pdfModal">
   <div class="pdf-container">
    <div class="pdf-header">
     <h3 class="pdf-title" id="pdfTitle">PDF Görüntüleyici</h3><button class="pdf-close" onclick="closePdfViewer()">✕</button>
    </div>
    <div class="pdf-viewer"><iframe class="pdf-iframe" id="pdfIframe" src=""></iframe>
    </div>
    <div class="pdf-footer"><button class="modal-btn primary" id="downloadPdfBtn" onclick="downloadPdf()" style="display: none;"> <span>📥</span> <span id="downloadText">PDF İndir</span> </button>
    </div>
   </div>
  </div><!-- New Request Modal -->
  <div class="form-modal" id="newRequestModal">
   <div class="modal-content">
    <div class="modal-header">
     <h3 class="modal-title" id="newRequestTitle">Yeni Talep Oluştur</h3><button class="modal-close" onclick="closeNewRequestModal()">✕</button>
    </div>
    <div class="modal-body">
     <form id="newRequestForm">
      <div class="form-group"><label class="form-label" id="descriptionLabel">Açıklama</label> <textarea class="form-textarea" id="descriptionInput" placeholder="Talep açıklamasını girin..." required></textarea>
      </div>
      <div class="form-group"><label class="form-label" id="amountLabel">Tahmini Tutar (₺)</label> <input type="number" class="form-input" id="amountInput" placeholder="0.00" step="0.01" min="0" required>
      </div>
      <div class="form-group"><label class="form-label" id="categoryLabel">Kategori</label> <select class="form-select" id="categoryInput" required> <option value="">Seçiniz</option> <option value="office">Ofis Malzemeleri</option> <option value="it">Bilgi İşlem</option> <option value="cleaning">Temizlik</option> <option value="furniture">Mobilya</option> <option value="other">Diğer</option> </select>
      </div>
     </form>
    </div>
    <div class="modal-footer"><button class="modal-btn secondary" onclick="closeNewRequestModal()" id="cancelBtn">İptal</button> <button class="modal-btn primary" onclick="submitNewRequest()" id="submitBtn">Talep Oluştur</button>
    </div>
   </div>
  </div><!-- Upload Report Modal -->
  <div class="form-modal" id="uploadReportModal">
   <div class="modal-content">
    <div class="modal-header">
     <h3 class="modal-title">📄 Yeni Rapor Yükle</h3><button class="modal-close" onclick="closeUploadReportModal()">✕</button>
    </div>
    <div class="modal-body">
     <form id="uploadReportForm">
      <div class="form-group"><label class="form-label">Rapor Adı</label> <input type="text" class="form-input" id="reportNameInput" placeholder="Rapor adını girin..." required>
      </div>
      <div class="form-group"><label class="form-label">İlgili Talep No</label> <select class="form-select" id="relatedRequestInput" required> <option value="">Talep seçiniz</option> <option value="RF100.SOFS-0001">RF100.SOFS-0001</option> <option value="RF100.SOFS-0002">RF100.SOFS-0002</option> <option value="RF100.SOFS-0003">RF100.SOFS-0003</option> <option value="RF100.SOFS-0004">RF100.SOFS-0004</option> <option value="RF100.SOFS-0005">RF100.SOFS-0005</option> </select>
      </div>
      <div class="form-group"><label class="form-label">PDF Dosyası</label> <input type="file" class="form-input" id="pdfFileInput" accept=".pdf" required>
      </div>
     </form>
    </div>
    <div class="modal-footer"><button class="modal-btn secondary" onclick="closeUploadReportModal()">İptal</button> <button class="modal-btn primary" onclick="submitUploadReport()">Rapor Yükle</button>
    </div>
   </div>
  </div><!-- Toast Notification -->
  <div class="toast" id="toast"></div><!-- Log Panel -->
  <div class="log-panel" id="logPanel">
   <div class="log-header"><span class="log-title">📋 İşlem Geçmişi</span> <button class="log-close" onclick="closeLogPanel()">✕</button>
   </div>
   <div class="log-entries" id="logEntries"><!-- Log entries will be populated here -->
   </div>
  </div>
  <script>
        // Configuration
        const defaultConfig = {
            system_name: "SOMTECH SOF ERP v9.2.0",
            company_name: "SOMTECH",
            version_number: "v9.2.0"
        };

        // Global Variables
        let currentUser = null;
        let currentLanguage = 'tr';
        let selectedRow = null;
        let currentPdfFile = null;
        let currentModule = 'requests';
        let logEntries = [];
        let reportCounter = 6;

        // User Database
        const users = {
            'user1': { password: '123456', name: 'Ahmet Yılmaz', role: 'user' },
            'manager1': { password: '123456', name: 'Mehmet Demir', role: 'manager' },
            'procurement1': { password: '123456', name: 'Fatma Özkan', role: 'procurement' },
            'accounting1': { password: '123456', name: 'Ali Kaya', role: 'accounting' }
        };

        // Language Translations
        const translations = {
            tr: {
                // Login
                login_title: "SOMTECH Satın Alma Sistemine Hoş Geldiniz",
                login_subtitle: "Lütfen kullanıcı bilgilerinizi girerek sisteme giriş yapınız.",
                username: "Kullanıcı Adı",
                password: "Şifre",
                login_button: "Giriş Yap",
                login_error: "Kullanıcı adı veya şifre hatalı.",
                
                // Menu
                dashboard: "Ana Panel",
                requests: "Talepler",
                approvals: "Onaylar",
                procurement: "Satın Alma",
                accounting: "Muhasebe",
                reports: "Raporlar",
                settings: "Ayarlar",
                logout: "Çıkış Yap",
                
                // Actions
                new_request: "Yeni Talep",
                export: "Dışa Aktar",
                pdf_view: "PDF Görüntüle",
                search: "Arama",
                status: "Durum",
                date: "Tarih",
                reset: "Sıfırla",
                
                // Table Headers
                request_no: "Talep No",
                requester: "Talep Eden",
                description: "Açıklama",
                amount: "Tutar",
                document: "Belge",
                actions: "İşlemler",
                
                // Status
                pending: "Bekliyor",
                approved: "Onaylandı",
                priced: "Fiyatlandı",
                paid: "Ödendi",
                rejected: "Reddedildi",
                all: "Tümü",
                
                // Form
                new_request_title: "Yeni Talep Oluştur",
                description_label: "Açıklama",
                amount_label: "Tahmini Tutar (₺)",
                category_label: "Kategori",
                cancel: "İptal",
                submit: "Talep Oluştur",
                
                // Actions
                approve: "Onayla",
                reject: "Reddet",
                set_price: "Fiyat Gir",
                send: "Gönder",
                mark_paid: "Ödeme Yapıldı",
                
                // Messages
                request_created: "Talep başarıyla oluşturuldu",
                request_approved: "Talep onaylandı",
                request_rejected: "Talep reddedildi",
                price_set: "Fiyat belirlendi",
                payment_marked: "Ödeme işaretlendi",
                
                // User Menu
                profile: "Profil",
                user_settings: "Ayarlar",
                
                // Roles
                user: "Kullanıcı",
                manager: "Müdür",
                procurement_role: "Satın Alma",
                accounting_role: "Muhasebe",
                
                // Report Forms
                report_forms: "Rapor Formu",
                add_report: "Yeni Rapor Ekle",
                report_name: "Rapor Adı",
                related_request: "İlgili Talep No",
                uploader: "Yükleyen Kullanıcı",
                view_report: "Görüntüle",
                download_report: "İndir",
                upload_report: "Rapor Yükle",
                report_uploaded: "Rapor formu başarıyla eklendi",
                auto_report_created: "için otomatik SOF raporu oluşturuldu"
            },
            
            en: {
                // Login
                login_title: "Welcome to SOMTECH Procurement System",
                login_subtitle: "Please enter your credentials to access the system.",
                username: "Username",
                password: "Password",
                login_button: "Login",
                login_error: "Username or password is incorrect.",
                
                // Menu
                dashboard: "Dashboard",
                requests: "Requests",
                approvals: "Approvals",
                procurement: "Procurement",
                accounting: "Accounting",
                reports: "Reports",
                settings: "Settings",
                logout: "Logout",
                
                // Actions
                new_request: "New Request",
                export: "Export",
                pdf_view: "View PDF",
                search: "Search",
                status: "Status",
                date: "Date",
                reset: "Reset",
                
                // Table Headers
                request_no: "Request No",
                requester: "Requester",
                description: "Description",
                amount: "Amount",
                document: "Document",
                actions: "Actions",
                
                // Status
                pending: "Pending",
                approved: "Approved",
                priced: "Priced",
                paid: "Paid",
                rejected: "Rejected",
                all: "All",
                
                // Form
                new_request_title: "Create New Request",
                description_label: "Description",
                amount_label: "Estimated Amount (₺)",
                category_label: "Category",
                cancel: "Cancel",
                submit: "Create Request",
                
                // Actions
                approve: "Approve",
                reject: "Reject",
                set_price: "Set Price",
                send: "Send",
                mark_paid: "Mark as Paid",
                
                // Messages
                request_created: "Request created successfully",
                request_approved: "Request approved",
                request_rejected: "Request rejected",
                price_set: "Price set",
                payment_marked: "Payment marked",
                
                // User Menu
                profile: "Profile",
                user_settings: "Settings",
                
                // Roles
                user: "User",
                manager: "Manager",
                procurement_role: "Procurement",
                accounting_role: "Accounting"
            },
            
            ru: {
                // Login
                login_title: "Добро пожаловать в систему закупок SOMTECH",
                login_subtitle: "Пожалуйста, введите свои учетные данные для входа в систему.",
                username: "Имя пользователя",
                password: "Пароль",
                login_button: "Войти",
                login_error: "Неверное имя пользователя или пароль.",
                
                // Menu
                dashboard: "Панель управления",
                requests: "Заявки",
                approvals: "Одобрения",
                procurement: "Закупки",
                accounting: "Бухгалтерия",
                reports: "Отчеты",
                settings: "Настройки",
                logout: "Выйти",
                
                // Actions
                new_request: "Новая заявка",
                export: "Экспорт",
                pdf_view: "Просмотр PDF",
                search: "Поиск",
                status: "Статус",
                date: "Дата",
                reset: "Сброс",
                
                // Table Headers
                request_no: "№ заявки",
                requester: "Заявитель",
                description: "Описание",
                amount: "Сумма",
                document: "Документ",
                actions: "Действия",
                
                // Status
                pending: "Ожидает",
                approved: "Одобрено",
                priced: "Оценено",
                paid: "Оплачено",
                rejected: "Отклонено",
                all: "Все",
                
                // Form
                new_request_title: "Создать новую заявку",
                description_label: "Описание",
                amount_label: "Предполагаемая сумма (₺)",
                category_label: "Категория",
                cancel: "Отмена",
                submit: "Создать заявку",
                
                // Actions
                approve: "Одобрить",
                reject: "Отклонить",
                set_price: "Установить цену",
                send: "Отправить",
                mark_paid: "Отметить как оплаченное",
                
                // Messages
                request_created: "Заявка успешно создана",
                request_approved: "Заявка одобрена",
                request_rejected: "Заявка отклонена",
                price_set: "Цена установлена",
                payment_marked: "Платеж отмечен",
                
                // User Menu
                profile: "Профиль",
                user_settings: "Настройки",
                
                // Roles
                user: "Пользователь",
                manager: "Менеджер",
                procurement_role: "Закупки",
                accounting_role: "Бухгалтерия"
            }
        };

        // Utility Functions
        function t(key) {
            return translations[currentLanguage]?.[key] || translations['tr'][key] || key;
        }

        function detectBrowserLanguage() {
            const browserLang = navigator.language || navigator.userLanguage || 'tr';
            const langCode = browserLang.toLowerCase();
            
            if (langCode.startsWith('tr')) return 'tr';
            if (langCode.startsWith('en')) return 'en';
            if (langCode.startsWith('ru')) return 'ru';
            
            return 'tr';
        }

        function initializeLanguage() {
            const savedLanguage = localStorage.getItem('lang');
            currentLanguage = savedLanguage || detectBrowserLanguage();
            localStorage.setItem('lang', currentLanguage);
            updateLanguageUI();
            updateLanguageFlag();
            translatePage();
        }

        function changeLanguage(lang) {
            if (lang === currentLanguage) return;
            
            currentLanguage = lang;
            localStorage.setItem('lang', lang);
            
            updateLanguageUI();
            translatePage();
            updateLanguageFlag();
            
            // Close dropdowns
            document.querySelectorAll('.dropdown').forEach(dropdown => {
                dropdown.classList.remove('active');
            });
            
            // Update user preferences if logged in
            if (currentUser) {
                currentUser.lang = lang;
                localStorage.setItem('user', JSON.stringify(currentUser));
            }
        }

        function updateLanguageFlag() {
            const flagElement = document.getElementById('currentLanguageFlag');
            const flags = {
                'tr': '🇹🇷',
                'en': '🇬🇧', 
                'ru': '🇷🇺'
            };
            
            if (flagElement && flags[currentLanguage]) {
                flagElement.textContent = flags[currentLanguage];
            }
        }

        function updateLanguageUI() {
            document.querySelectorAll('.dropdown-item').forEach(item => {
                item.classList.remove('active');
                if (item.dataset.lang === currentLanguage) {
                    item.classList.add('active');
                }
            });
        }

        function translatePage() {
            // Login screen
            const loginTitle = document.getElementById('loginTitle');
            const loginSubtitle = document.getElementById('loginSubtitle');
            const usernameLabel = document.getElementById('usernameLabel');
            const passwordLabel = document.getElementById('passwordLabel');
            const loginButton = document.getElementById('loginButton');
            
            if (loginTitle) loginTitle.textContent = t('login_title');
            if (loginSubtitle) loginSubtitle.textContent = t('login_subtitle');
            if (usernameLabel) usernameLabel.textContent = t('username');
            if (passwordLabel) passwordLabel.textContent = t('password');
            if (loginButton) loginButton.textContent = t('login_button');
            
            // Menu items
            const menuDashboard = document.getElementById('menuDashboard');
            const menuRequests = document.getElementById('menuRequests');
            const menuApprovals = document.getElementById('menuApprovals');
            const menuProcurement = document.getElementById('menuProcurement');
            const menuAccounting = document.getElementById('menuAccounting');
            const menuReports = document.getElementById('menuReports');
            const menuReportForms = document.getElementById('menuReportForms');
            const menuSettings = document.getElementById('menuSettings');
            const logoutText = document.getElementById('logoutText');
            
            if (menuDashboard) menuDashboard.textContent = t('dashboard');
            if (menuRequests) menuRequests.textContent = t('requests');
            if (menuApprovals) menuApprovals.textContent = t('approvals');
            if (menuProcurement) menuProcurement.textContent = t('procurement');
            if (menuAccounting) menuAccounting.textContent = t('accounting');
            if (menuReports) menuReports.textContent = t('reports');
            if (menuReportForms) menuReportForms.textContent = t('report_forms');
            if (menuSettings) menuSettings.textContent = t('settings');
            if (logoutText) logoutText.textContent = t('logout');
            
            // Action buttons
            const newRequestText = document.getElementById('newRequestText');
            const exportText = document.getElementById('exportText');
            const pdfViewText = document.getElementById('pdfViewText');
            
            if (newRequestText) newRequestText.textContent = t('new_request');
            if (exportText) exportText.textContent = t('export');
            if (pdfViewText) pdfViewText.textContent = t('pdf_view');
            
            // Filter labels
            const searchLabel = document.getElementById('searchLabel');
            const statusLabel = document.getElementById('statusLabel');
            const dateLabel = document.getElementById('dateLabel');
            const resetText = document.getElementById('resetText');
            
            if (searchLabel) searchLabel.textContent = t('search');
            if (statusLabel) statusLabel.textContent = t('status');
            if (dateLabel) dateLabel.textContent = t('date');
            if (resetText) resetText.textContent = t('reset');
            
            // Table headers
            const thRequestNo = document.getElementById('thRequestNo');
            const thDate = document.getElementById('thDate');
            const thRequester = document.getElementById('thRequester');
            const thDescription = document.getElementById('thDescription');
            const thAmount = document.getElementById('thAmount');
            const thStatus = document.getElementById('thStatus');
            const thDocument = document.getElementById('thDocument');
            const thActions = document.getElementById('thActions');
            
            if (thRequestNo) thRequestNo.textContent = t('request_no');
            if (thDate) thDate.textContent = t('date');
            if (thRequester) thRequester.textContent = t('requester');
            if (thDescription) thDescription.textContent = t('description');
            if (thAmount) thAmount.textContent = t('amount');
            if (thStatus) thStatus.textContent = t('status');
            if (thDocument) thDocument.textContent = t('document');
            if (thActions) thActions.textContent = t('actions');
            
            // Status filter options
            const statusFilter = document.getElementById('statusFilter');
            if (statusFilter) {
                const options = statusFilter.querySelectorAll('option');
                if (options[0]) options[0].textContent = t('all');
                if (options[1]) options[1].textContent = t('pending');
                if (options[2]) options[2].textContent = t('approved');
                if (options[3]) options[3].textContent = t('priced');
                if (options[4]) options[4].textContent = t('paid');
                if (options[5]) options[5].textContent = t('rejected');
            }
            
            // User menu
            const profileText = document.getElementById('profileText');
            const settingsText = document.getElementById('settingsText');
            const logoutMenuText = document.getElementById('logoutMenuText');
            
            if (profileText) profileText.textContent = t('profile');
            if (settingsText) settingsText.textContent = t('user_settings');
            if (logoutMenuText) logoutMenuText.textContent = t('logout');
            
            // Modal elements
            const newRequestTitle = document.getElementById('newRequestTitle');
            const descriptionLabel = document.getElementById('descriptionLabel');
            const amountLabel = document.getElementById('amountLabel');
            const categoryLabel = document.getElementById('categoryLabel');
            const cancelBtn = document.getElementById('cancelBtn');
            const submitBtn = document.getElementById('submitBtn');
            
            if (newRequestTitle) newRequestTitle.textContent = t('new_request_title');
            if (descriptionLabel) descriptionLabel.textContent = t('description_label');
            if (amountLabel) amountLabel.textContent = t('amount_label');
            if (categoryLabel) categoryLabel.textContent = t('category_label');
            if (cancelBtn) cancelBtn.textContent = t('cancel');
            if (submitBtn) submitBtn.textContent = t('submit');
        }

        // Theme Functions
        function toggleTheme() {
            const currentTheme = document.documentElement.getAttribute('data-theme');
            const newTheme = currentTheme === 'light' ? 'dark' : 'light';
            
            document.documentElement.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
            
            updateThemeIcons();
            
            if (currentUser) {
                currentUser.theme = newTheme;
                localStorage.setItem('user', JSON.stringify(currentUser));
            }
        }

        function updateThemeIcons() {
            const currentTheme = document.documentElement.getAttribute('data-theme');
            const themeIcon = document.getElementById('themeIcon');
            const loginThemeIcon = document.getElementById('loginThemeIcon');
            
            const icon = currentTheme === 'light' ? '☀️' : '🌙';
            if (themeIcon) themeIcon.textContent = icon;
            if (loginThemeIcon) loginThemeIcon.textContent = icon;
        }

        function initializeTheme() {
            const savedTheme = localStorage.getItem('theme') || 'dark';
            document.documentElement.setAttribute('data-theme', savedTheme);
            updateThemeIcons();
        }

        // Authentication Functions
        function checkLoginStatus() {
            const savedUser = localStorage.getItem('user');
            if (savedUser) {
                try {
                    currentUser = JSON.parse(savedUser);
                    showMainApplication();
                    return true;
                } catch (e) {
                    localStorage.removeItem('user');
                }
            }
            showLoginScreen();
            return false;
        }

        function showLoginScreen() {
            document.getElementById('loginScreen').style.display = 'flex';
            document.getElementById('appContainer').classList.remove('active');
        }

        function showMainApplication() {
            document.getElementById('loginScreen').style.display = 'none';
            document.getElementById('appContainer').classList.add('active');
            
            // Apply user preferences
            if (currentUser.theme) {
                document.documentElement.setAttribute('data-theme', currentUser.theme);
                updateThemeIcons();
            }
            
            if (currentUser.lang) {
                currentLanguage = currentUser.lang;
                updateLanguageUI();
                translatePage();
            }
            
            // Apply role-based theme
            document.documentElement.setAttribute('data-role', currentUser.role);
            
            // Update user menu
            updateUserMenu();
            
            // Configure UI based on role
            configureUIForRole();
        }

        function handleLogin(event) {
            event.preventDefault();
            
            // Show loading screen
            showLoadingScreen();
            
            // Simulate login process with animation
            setTimeout(() => {
                // Create dummy user for demo
                currentUser = {
                    username: 'demo',
                    name: 'Demo Kullanıcı',
                    role: 'manager',
                    lang: currentLanguage,
                    theme: document.documentElement.getAttribute('data-theme') || 'dark'
                };
                
                localStorage.setItem('user', JSON.stringify(currentUser));
                
                // Redirect to dashboard.html after animation
                setTimeout(() => {
                    window.location.href = 'dashboard.html';
                }, 1500);
                
            }, 100);
        }

        function showLoadingScreen() {
            const loginScreen = document.getElementById('loginScreen');
            const loadingScreen = document.getElementById('loadingScreen');
            
            // Hide login screen
            loginScreen.style.opacity = '0';
            loginScreen.style.transform = 'scale(0.95)';
            
            setTimeout(() => {
                loginScreen.style.display = 'none';
                loadingScreen.classList.add('active');
                
                // Start the complete loading sequence
                setTimeout(() => {
                    // After all animations complete, fade out and redirect
                    loadingScreen.style.animation = 'screen-fadeout 0.8s ease-out forwards';
                    
                    setTimeout(() => {
                        window.location.href = 'dashboard.html';
                    }, 800);
                }, 8500); // Total animation duration: 8.5 seconds (includes bilingual slogans + globe transition)
                
            }, 300);
        }

        function showLoginError() {
            const errorPopup = document.getElementById('loginError');
            errorPopup.textContent = t('login_error');
            errorPopup.classList.add('active');
            
            setTimeout(() => {
                errorPopup.classList.remove('active');
            }, 3000);
        }

        function updateUserMenu() {
            if (!currentUser) return;
            
            const userMenuText = document.getElementById('userMenuText');
            const roleText = t(currentUser.role + '_role') || t(currentUser.role);
            userMenuText.textContent = `${currentUser.name}`;
        }

        function configureUIForRole() {
            if (!currentUser) return;
            
            const role = currentUser.role;
            const newRequestBtn = document.getElementById('newRequestBtn');
            
            // Show/hide new request button based on role
            if (role === 'user') {
                newRequestBtn.style.display = 'flex';
            } else {
                newRequestBtn.style.display = 'none';
            }
            
            // Configure action buttons visibility
            configureActionButtons();
            
            // Filter table data based on role
            filterTableByRole();
        }

        function configureActionButtons() {
            if (!currentUser) return;
            
            const role = currentUser.role;
            const rows = document.querySelectorAll('#tableBody tr');
            
            rows.forEach(row => {
                const status = getRowStatus(row);
                const actionButtons = row.querySelector('.action-buttons');
                const approveBtn = actionButtons.querySelector('.approve');
                const rejectBtn = actionButtons.querySelector('.reject');
                const priceBtn = actionButtons.querySelector('.price');
                const paymentBtn = actionButtons.querySelector('.payment');
                
                // Hide all buttons first
                [approveBtn, rejectBtn, priceBtn, paymentBtn].forEach(btn => {
                    if (btn) btn.style.display = 'none';
                });
                
                // Show buttons based on role and status
                switch (role) {
                    case 'manager':
                        if (status === 'pending' || status === 'priced') {
                            if (approveBtn) approveBtn.style.display = 'inline-flex';
                            if (rejectBtn) rejectBtn.style.display = 'inline-flex';
                        }
                        break;
                    case 'procurement':
                        if (status === 'approved') {
                            if (priceBtn) priceBtn.style.display = 'inline-flex';
                        }
                        break;
                    case 'accounting':
                        if (status === 'priced') {
                            if (paymentBtn) paymentBtn.style.display = 'inline-flex';
                        }
                        break;
                }
            });
            
            // Configure report download buttons
            const reportRows = document.querySelectorAll('#reportTableBody tr');
            reportRows.forEach(row => {
                const downloadBtn = row.querySelector('.download');
                if (downloadBtn) {
                    if (role === 'manager' || role === 'procurement' || role === 'accounting') {
                        downloadBtn.style.display = 'inline-flex';
                    } else {
                        downloadBtn.style.display = 'none';
                    }
                }
            });
        }

        function switchModule(module) {
            currentModule = module;
            
            // Update menu active state
            document.querySelectorAll('.menu-item').forEach(item => {
                item.classList.remove('active');
                if (item.dataset.module === module) {
                    item.classList.add('active');
                }
            });
            
            // Update page title
            const pageTitleCenter = document.getElementById('pageTitleCenter');
            const moduleNames = {
                'dashboard': 'Ana Panel',
                'requests': 'Talepler',
                'approvals': 'Onaylar',
                'procurement': 'Satın Alma',
                'accounting': 'Muhasebe',
                'reports': 'Raporlar',
                'report-forms': 'Rapor Formları',
                'settings': 'Ayarlar'
            };
            
            if (pageTitleCenter && moduleNames[module]) {
                pageTitleCenter.textContent = moduleNames[module];
            }
            
            // Show/hide appropriate tables
            const requestsTable = document.getElementById('requestsTable');
            const reportFormsTable = document.getElementById('reportFormsTable');
            
            if (module === 'report-forms') {
                requestsTable.style.display = 'none';
                reportFormsTable.style.display = 'block';
            } else {
                requestsTable.style.display = 'block';
                reportFormsTable.style.display = 'none';
            }
            
            // Hide smart panel when switching modules
            hideSmartPanel();
        }

        function filterTableByRole() {
            const tableBody = document.getElementById('tableBody');
            const rows = tableBody.querySelectorAll('tr');
            
            rows.forEach(row => {
                const status = getRowStatus(row);
                let showRow = true;
                
                switch (currentUser.role) {
                    case 'user':
                        // Users only see their own requests
                        const requester = row.cells[2].textContent;
                        showRow = requester === currentUser.name;
                        break;
                    case 'manager':
                        // Managers see all requests
                        showRow = true;
                        break;
                    case 'procurement':
                        // Procurement sees approved requests
                        showRow = ['approved', 'priced'].includes(status);
                        break;
                    case 'accounting':
                        // Accounting sees priced requests
                        showRow = ['priced', 'paid'].includes(status);
                        break;
                }
                
                row.style.display = showRow ? '' : 'none';
            });
        }

        function getRowStatus(row) {
            const statusCell = row.querySelector('.status-badge');
            if (!statusCell) return '';
            
            const statusText = statusCell.textContent.toLowerCase();
            if (statusText.includes('bekliyor') || statusText.includes('pending')) return 'pending';
            if (statusText.includes('onaylandı') || statusText.includes('approved')) return 'approved';
            if (statusText.includes('fiyatlandı') || statusText.includes('priced')) return 'priced';
            if (statusText.includes('ödendi') || statusText.includes('paid')) return 'paid';
            if (statusText.includes('reddedildi') || statusText.includes('rejected')) return 'rejected';
            
            return '';
        }

        function logout() {
            localStorage.removeItem('user');
            currentUser = null;
            document.getElementById('loginForm').reset();
            showLoginScreen();
            
            // Close any open dropdowns
            document.querySelectorAll('.dropdown').forEach(dropdown => {
                dropdown.classList.remove('active');
            });
        }

        // UI Functions
        function toggleLanguageDropdown() {
            const dropdown = document.getElementById('languageDropdown');
            dropdown.classList.toggle('active');
            
            // Close other dropdowns
            document.getElementById('userDropdown').classList.remove('active');
            
            document.addEventListener('click', function closeDropdown(e) {
                if (!e.target.closest('#languageBtn') && !e.target.closest('#languageDropdown')) {
                    dropdown.classList.remove('active');
                    document.removeEventListener('click', closeDropdown);
                }
            });
        }

        function toggleLoginLanguageDropdown() {
            const dropdown = document.getElementById('loginLanguageDropdown');
            dropdown.classList.toggle('active');
            
            document.addEventListener('click', function closeDropdown(e) {
                if (!e.target.closest('#loginLanguageBtn') && !e.target.closest('#loginLanguageDropdown')) {
                    dropdown.classList.remove('active');
                    document.removeEventListener('click', closeDropdown);
                }
            });
        }

        function toggleUserMenu() {
            const dropdown = document.getElementById('userDropdown');
            dropdown.classList.toggle('active');
            
            // Close other dropdowns
            document.getElementById('languageDropdown').classList.remove('active');
            
            document.addEventListener('click', function closeDropdown(e) {
                if (!e.target.closest('#userMenuBtn') && !e.target.closest('#userDropdown')) {
                    dropdown.classList.remove('active');
                    document.removeEventListener('click', closeDropdown);
                }
            });
        }

        function selectRow(row) {
            // Remove previous selection
            if (selectedRow) {
                selectedRow.classList.remove('selected');
            }
            
            // Select new row
            selectedRow = row;
            row.classList.add('selected');
            
            // Show smart panel
            showSmartPanel(row);
        }

        function showSmartPanel(row) {
            const panel = document.getElementById('smartPanel');
            const selectedInfo = document.getElementById('selectedInfo');
            const selectedRequest = document.getElementById('selectedRequest');
            const panelActions = document.getElementById('panelActions');
            
            // Update panel info
            const requestNo = row.cells[0].textContent;
            const description = row.cells[3].textContent;
            selectedRequest.textContent = `${requestNo} - ${description}`;
            
            // Generate actions based on role and status
            const status = getRowStatus(row);
            panelActions.innerHTML = generatePanelActions(status);
            
            // Show panel
            panel.classList.add('active');
        }

        function generatePanelActions(status) {
            const role = currentUser.role;
            let actions = '';
            
            switch (role) {
                case 'manager':
                    if (status === 'pending') {
                        actions = `
                            <button class="panel-btn approve" onclick="approveRequest()">
                                ✅ ${t('approve')}
                            </button>
                            <button class="panel-btn reject" onclick="rejectRequest()">
                                ❌ ${t('reject')}
                            </button>
                        `;
                    } else if (status === 'priced') {
                        actions = `
                            <button class="panel-btn approve" onclick="approveRequest()">
                                ✅ ${t('approve')}
                            </button>
                            <button class="panel-btn reject" onclick="rejectRequest()">
                                ❌ ${t('reject')}
                            </button>
                        `;
                    }
                    break;
                case 'procurement':
                    if (status === 'approved') {
                        actions = `
                            <button class="panel-btn price" onclick="setPriceModal()">
                                💰 ${t('set_price')}
                            </button>
                        `;
                    }
                    break;
                case 'accounting':
                    if (status === 'priced') {
                        actions = `
                            <button class="panel-btn payment" onclick="markAsPaid()">
                                💳 ${t('mark_paid')}
                            </button>
                        `;
                    }
                    break;
            }
            
            return actions;
        }

        function hideSmartPanel() {
            const panel = document.getElementById('smartPanel');
            panel.classList.remove('active');
            
            if (selectedRow) {
                selectedRow.classList.remove('selected');
                selectedRow = null;
            }
        }

        // Action Functions
        function approveRequest() {
            if (!selectedRow) return;
            
            const requestNo = selectedRow.cells[0].textContent;
            const currentStatus = getRowStatus(selectedRow);
            
            if (currentStatus === 'pending') {
                updateRowStatus(selectedRow, 'approved');
                showToast(`${t('request_approved')}: ${requestNo}`, 'success');
            } else if (currentStatus === 'priced') {
                updateRowStatus(selectedRow, 'paid');
                showToast(`${t('request_approved')}: ${requestNo}`, 'success');
            }
            
            hideSmartPanel();
        }

        function rejectRequest() {
            if (!selectedRow) return;
            
            const requestNo = selectedRow.cells[0].textContent;
            updateRowStatus(selectedRow, 'rejected');
            showToast(`${t('request_rejected')}: ${requestNo}`, 'error');
            hideSmartPanel();
        }

        function setPriceModal() {
            // Simple prompt for demo - in real app would be a proper modal
            const price = prompt('Fiyat girin (₺):');
            if (price && !isNaN(price)) {
                selectedRow.cells[4].textContent = parseFloat(price).toFixed(2) + ' ₺';
                updateRowStatus(selectedRow, 'priced');
                showToast(`${t('price_set')}: ${price} ₺`, 'success');
                hideSmartPanel();
            }
        }

        function markAsPaid() {
            if (!selectedRow) return;
            
            const requestNo = selectedRow.cells[0].textContent;
            updateRowStatus(selectedRow, 'paid');
            showToast(`${t('payment_marked')}: ${requestNo}`, 'success');
            hideSmartPanel();
        }

        // Inline Action Functions
        function approveRequestInline(button) {
            const row = button.closest('tr');
            const requestNo = row.dataset.requestNo;
            const currentStatus = getRowStatus(row);
            
            // Add highlight animation
            row.classList.add('row-highlight');
            setTimeout(() => row.classList.remove('row-highlight'), 1000);
            
            if (currentStatus === 'pending') {
                updateRowStatus(row, 'approved');
                showToast(`✅ Talep ${requestNo} onaylandı`, 'success');
                addLogEntry(`${currentUser.name}, ${requestNo} talebini onayladı`);
                generateAutoReport(requestNo, 'Onay Belgesi');
            } else if (currentStatus === 'priced') {
                updateRowStatus(row, 'paid');
                showToast(`✅ Talep ${requestNo} final onayı verildi`, 'success');
                addLogEntry(`${currentUser.name}, ${requestNo} talebine final onayı verdi`);
                generateAutoReport(requestNo, 'Final Onay Belgesi');
            }
            
            configureActionButtons();
        }

        function rejectRequestInline(button) {
            const row = button.closest('tr');
            const requestNo = row.dataset.requestNo;
            
            // Add highlight animation
            row.classList.add('row-highlight');
            setTimeout(() => row.classList.remove('row-highlight'), 1000);
            
            updateRowStatus(row, 'rejected');
            showToast(`❌ Talep ${requestNo} reddedildi`, 'error');
            addLogEntry(`${currentUser.name}, ${requestNo} talebini reddetti`);
            
            configureActionButtons();
        }

        function setPriceInline(button) {
            const row = button.closest('tr');
            const requestNo = row.dataset.requestNo;
            
            // Create inline price input
            const priceInput = document.createElement('input');
            priceInput.type = 'number';
            priceInput.placeholder = 'Fiyat girin...';
            priceInput.style.cssText = `
                width: 120px;
                padding: 0.25rem 0.5rem;
                border: 2px solid var(--accent-primary);
                border-radius: 4px;
                background: var(--bg-secondary);
                color: var(--text-primary);
                font-size: 0.75rem;
                margin-right: 0.5rem;
            `;
            
            const confirmBtn = document.createElement('button');
            confirmBtn.textContent = '✓';
            confirmBtn.className = 'action-btn approve';
            confirmBtn.style.cssText = 'padding: 0.25rem 0.5rem; font-size: 0.75rem;';
            
            const cancelBtn = document.createElement('button');
            cancelBtn.textContent = '✕';
            cancelBtn.className = 'action-btn reject';
            cancelBtn.style.cssText = 'padding: 0.25rem 0.5rem; font-size: 0.75rem;';
            
            const actionCell = button.parentElement;
            const originalContent = actionCell.innerHTML;
            
            actionCell.innerHTML = '';
            actionCell.appendChild(priceInput);
            actionCell.appendChild(confirmBtn);
            actionCell.appendChild(cancelBtn);
            
            priceInput.focus();
            
            confirmBtn.onclick = function() {
                const price = parseFloat(priceInput.value);
                if (price && price > 0) {
                    row.cells[4].textContent = price.toFixed(2) + ' ₺';
                    updateRowStatus(row, 'priced');
                    showToast(`💰 ${requestNo} için fiyat belirlendi: ${price.toFixed(2)} ₺`, 'success');
                    addLogEntry(`${currentUser.name}, ${requestNo} için ${price.toFixed(2)} ₺ fiyat belirledi`);
                    generateAutoReport(requestNo, 'Fiyat Onay Belgesi');
                    
                    // Add highlight animation
                    row.classList.add('row-highlight');
                    setTimeout(() => row.classList.remove('row-highlight'), 1000);
                    
                    actionCell.innerHTML = originalContent;
                    configureActionButtons();
                } else {
                    showToast('Geçerli bir fiyat girin', 'error');
                }
            };
            
            cancelBtn.onclick = function() {
                actionCell.innerHTML = originalContent;
                configureActionButtons();
            };
            
            priceInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    confirmBtn.click();
                } else if (e.key === 'Escape') {
                    cancelBtn.click();
                }
            });
        }

        function markAsPaidInline(button) {
            const row = button.closest('tr');
            const requestNo = row.dataset.requestNo;
            
            // Add highlight animation
            row.classList.add('row-highlight');
            setTimeout(() => row.classList.remove('row-highlight'), 1000);
            
            updateRowStatus(row, 'paid');
            showToast(`💳 Talep ${requestNo} ödeme yapıldı olarak işaretlendi`, 'success');
            addLogEntry(`${currentUser.name}, ${requestNo} için ödeme yapıldı işaretlemesi yaptı`);
            generateAutoReport(requestNo, 'Ödeme Onay Belgesi');
            
            configureActionButtons();
        }

        function generateAutoReport(requestNo, reportType) {
            const reportName = `${reportType} – ${requestNo}`;
            const fileName = `${requestNo}_SOF_RAPOR.pdf`;
            const today = new Date().toLocaleDateString('tr-TR');
            
            // Add to report table
            const reportTableBody = document.getElementById('reportTableBody');
            const newRow = document.createElement('tr');
            newRow.className = 'report-row';
            newRow.setAttribute('onclick', 'selectReportRow(this)');
            
            newRow.innerHTML = `
                <td>${reportName}</td>
                <td>${requestNo}</td>
                <td>${currentUser.name}</td>
                <td>${today}</td>
                <td class="report-actions">
                    <button class="action-btn view" onclick="viewReportPdf('${fileName}', '${requestNo}')">📄 Görüntüle</button>
                    <button class="action-btn download" onclick="downloadReportPdf('${fileName}')" style="display: none;">📥 İndir</button>
                </td>
            `;
            
            reportTableBody.insertBefore(newRow, reportTableBody.firstChild);
            
            // Configure download button visibility
            configureActionButtons();
            
            // Add log entry
            addLogEntry(`Sistem, ${requestNo} ${t('auto_report_created')}`);
            
            // Show notification
            setTimeout(() => {
                showToast(`✅ ${requestNo} ${t('auto_report_created')}`, 'success');
            }, 500);
        }

        function updateRowStatus(row, newStatus) {
            const statusCell = row.querySelector('.status-badge');
            const statusMap = {
                'pending': { text: t('pending'), class: 'status-pending' },
                'approved': { text: t('approved'), class: 'status-approved' },
                'priced': { text: t('priced'), class: 'status-priced' },
                'paid': { text: t('paid'), class: 'status-paid' },
                'rejected': { text: t('rejected'), class: 'status-rejected' }
            };
            
            // Remove old status classes
            Object.values(statusMap).forEach(status => {
                row.classList.remove(status.class);
            });
            
            // Add new status class
            row.classList.add(statusMap[newStatus].class);
            statusCell.textContent = statusMap[newStatus].text;
        }

        // Modal Functions
        function openNewRequestModal() {
            document.getElementById('newRequestModal').classList.add('active');
        }

        function closeNewRequestModal() {
            document.getElementById('newRequestModal').classList.remove('active');
            document.getElementById('newRequestForm').reset();
        }

        function submitNewRequest() {
            const description = document.getElementById('descriptionInput').value;
            const amount = document.getElementById('amountInput').value;
            const category = document.getElementById('categoryInput').value;
            
            if (!description || !amount || !category) {
                showToast('Lütfen tüm alanları doldurun', 'error');
                return;
            }
            
            // Add new row to table
            const tableBody = document.getElementById('tableBody');
            const newRow = document.createElement('tr');
            const requestNo = `REQ-2024-${String(tableBody.children.length + 1).padStart(3, '0')}`;
            const today = new Date().toLocaleDateString('tr-TR');
            
            newRow.className = 'status-pending';
            newRow.setAttribute('data-id', tableBody.children.length + 1);
            newRow.setAttribute('onclick', 'selectRow(this)');
            
            newRow.innerHTML = `
                <td>${requestNo}</td>
                <td>${today}</td>
                <td>${currentUser.name}</td>
                <td>${description}</td>
                <td>${parseFloat(amount).toFixed(2)} ₺</td>
                <td><span class="status-badge">${t('pending')}</span></td>
                <td>📎 <a href="#" onclick="openPdfViewer('${requestNo}.pdf')">PDF</a></td>
                <td>-</td>
            `;
            
            tableBody.appendChild(newRow);
            
            closeNewRequestModal();
            showToast(`${t('request_created')}: ${requestNo}`, 'success');
        }

        function openPdfViewer(filename) {
            currentPdfFile = filename;
            document.getElementById('pdfTitle').textContent = `PDF: ${filename}`;
            document.getElementById('pdfModal').classList.add('active');
            
            // In a real app, you would load the actual PDF
            // For demo, we'll show a placeholder
            const iframe = document.getElementById('pdfIframe');
            iframe.src = 'data:text/html,<div style="padding:20px;text-align:center;font-family:Arial;"><h2>PDF Önizleme</h2><p>Dosya: ' + filename + '</p><p>Bu bir demo görünümüdür.</p></div>';
            
            // Show download button for managers and above
            const downloadBtn = document.getElementById('downloadPdfBtn');
            if (currentUser.role === 'manager' || currentUser.role === 'procurement' || currentUser.role === 'accounting') {
                downloadBtn.style.display = 'flex';
            } else {
                downloadBtn.style.display = 'none';
            }
        }

        function closePdfViewer() {
            document.getElementById('pdfModal').classList.remove('active');
            currentPdfFile = null;
        }

        function downloadPdf() {
            if (currentPdfFile) {
                showToast(`PDF indiriliyor: ${currentPdfFile}`, 'success');
                // In a real app, you would trigger the actual download
            }
        }

        // Utility Functions
        function showToast(message, type = 'success') {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.className = `toast ${type}`;
            toast.classList.add('active');
            
            setTimeout(() => {
                toast.classList.remove('active');
            }, 3000);
        }

        function exportData() {
            showToast('Veriler dışa aktarılıyor...', 'success');
            // In a real app, you would export the filtered data
        }

        function resetFilters() {
            document.getElementById('searchInput').value = '';
            document.getElementById('statusFilter').value = '';
            document.getElementById('dateFilter').value = '';
            
            // Show all rows based on role
            filterTableByRole();
            
            showToast('Filtreler sıfırlandı', 'success');
        }

        function openProfile() {
            document.getElementById('userDropdown').classList.remove('active');
            showToast(`Profil: ${currentUser.name} (${t(currentUser.role + '_role')})`, 'info');
        }

        function openSettings() {
            document.getElementById('userDropdown').classList.remove('active');
            showToast('Ayarlar sayfası açılıyor...', 'info');
        }

        // Report Functions
        function selectReportRow(row) {
            // Remove previous selection
            document.querySelectorAll('.report-row').forEach(r => r.classList.remove('selected'));
            
            // Select new row
            row.classList.add('selected');
        }

        function viewReportPdf(filename, requestNo) {
            const reportTitle = `📄 ${filename}`;
            document.getElementById('pdfTitle').textContent = reportTitle;
            document.getElementById('pdfModal').classList.add('active');
            
            // Generate PDF content based on request data
            const requestRow = document.querySelector(`[data-request-no="${requestNo}"]`);
            let pdfContent = `
                <div style="padding: 2rem; font-family: Arial, sans-serif; background: white; color: black; min-height: 100%;">
                    <div style="text-align: center; margin-bottom: 2rem; border-bottom: 2px solid #22D3EE; padding-bottom: 1rem;">
                        <h1 style="color: #22D3EE; margin: 0;">SOMTECH SOF ERP v9.0</h1>
                        <h2 style="color: #333; margin: 0.5rem 0;">Satın Alma Onay Raporu</h2>
                    </div>
                    
                    <div style="margin-bottom: 2rem;">
                        <h3 style="color: #22D3EE; border-bottom: 1px solid #eee; padding-bottom: 0.5rem;">Talep Bilgileri</h3>
                        <table style="width: 100%; border-collapse: collapse; margin-top: 1rem;">
                            <tr><td style="padding: 0.5rem; border: 1px solid #ddd; font-weight: bold; background: #f9f9f9;">Talep No:</td><td style="padding: 0.5rem; border: 1px solid #ddd;">${requestNo}</td></tr>
            `;
            
            if (requestRow) {
                const cells = requestRow.cells;
                pdfContent += `
                            <tr><td style="padding: 0.5rem; border: 1px solid #ddd; font-weight: bold; background: #f9f9f9;">Tarih:</td><td style="padding: 0.5rem; border: 1px solid #ddd;">${cells[1].textContent}</td></tr>
                            <tr><td style="padding: 0.5rem; border: 1px solid #ddd; font-weight: bold; background: #f9f9f9;">Talep Eden:</td><td style="padding: 0.5rem; border: 1px solid #ddd;">${cells[2].textContent}</td></tr>
                            <tr><td style="padding: 0.5rem; border: 1px solid #ddd; font-weight: bold; background: #f9f9f9;">Açıklama:</td><td style="padding: 0.5rem; border: 1px solid #ddd;">${cells[3].textContent}</td></tr>
                            <tr><td style="padding: 0.5rem; border: 1px solid #ddd; font-weight: bold; background: #f9f9f9;">Tutar:</td><td style="padding: 0.5rem; border: 1px solid #ddd;">${cells[4].textContent}</td></tr>
                            <tr><td style="padding: 0.5rem; border: 1px solid #ddd; font-weight: bold; background: #f9f9f9;">Durum:</td><td style="padding: 0.5rem; border: 1px solid #ddd;">${cells[5].textContent}</td></tr>
                `;
            }
            
            pdfContent += `
                        </table>
                    </div>
                    
                    <div style="margin-bottom: 2rem;">
                        <h3 style="color: #22D3EE; border-bottom: 1px solid #eee; padding-bottom: 0.5rem;">Onay Bilgileri</h3>
                        <table style="width: 100%; border-collapse: collapse; margin-top: 1rem;">
                            <tr><td style="padding: 0.5rem; border: 1px solid #ddd; font-weight: bold; background: #f9f9f9;">Onaylayan:</td><td style="padding: 0.5rem; border: 1px solid #ddd;">${currentUser.name}</td></tr>
                            <tr><td style="padding: 0.5rem; border: 1px solid #ddd; font-weight: bold; background: #f9f9f9;">Rol:</td><td style="padding: 0.5rem; border: 1px solid #ddd;">${t(currentUser.role + '_role')}</td></tr>
                            <tr><td style="padding: 0.5rem; border: 1px solid #ddd; font-weight: bold; background: #f9f9f9;">Onay Tarihi:</td><td style="padding: 0.5rem; border: 1px solid #ddd;">${new Date().toLocaleDateString('tr-TR')} ${new Date().toLocaleTimeString('tr-TR')}</td></tr>
                        </table>
                    </div>
                    
                    <div style="margin-top: 3rem; text-align: center;">
                        <div style="border: 2px solid #22D3EE; padding: 1rem; border-radius: 8px; background: #f0f9ff;">
                            <p style="margin: 0; font-weight: bold; color: #22D3EE;">Bu belge SOMTECH SOF ERP v9.0 sistemi tarafından otomatik olarak oluşturulmuştur.</p>
                            <p style="margin: 0.5rem 0 0 0; font-size: 0.9rem; color: #666;">Oluşturulma Zamanı: ${new Date().toLocaleString('tr-TR')}</p>
                        </div>
                    </div>
                </div>
            `;
            
            const iframe = document.getElementById('pdfIframe');
            iframe.src = 'data:text/html;charset=utf-8,' + encodeURIComponent(pdfContent);
            
            // Show download button for authorized users
            const downloadBtn = document.getElementById('downloadPdfBtn');
            if (currentUser.role === 'manager' || currentUser.role === 'procurement' || currentUser.role === 'accounting') {
                downloadBtn.style.display = 'flex';
            } else {
                downloadBtn.style.display = 'none';
            }
            
            currentPdfFile = filename;
        }

        function downloadReportPdf(filename) {
            showToast(`📥 ${filename} indiriliyor...`, 'success');
            addLogEntry(`${currentUser.name}, ${filename} dosyasını indirdi`);
        }

        function openUploadReportModal() {
            document.getElementById('uploadReportModal').classList.add('active');
        }

        function closeUploadReportModal() {
            document.getElementById('uploadReportModal').classList.remove('active');
            document.getElementById('uploadReportForm').reset();
        }

        function submitUploadReport() {
            const reportName = document.getElementById('reportNameInput').value;
            const relatedRequest = document.getElementById('relatedRequestInput').value;
            const pdfFile = document.getElementById('pdfFileInput').files[0];
            
            if (!reportName || !relatedRequest || !pdfFile) {
                showToast('Lütfen tüm alanları doldurun', 'error');
                return;
            }
            
            if (pdfFile.type !== 'application/pdf') {
                showToast('Lütfen sadece PDF dosyası yükleyin', 'error');
                return;
            }
            
            // Add new report to table
            const reportTableBody = document.getElementById('reportTableBody');
            const newRow = document.createElement('tr');
            const today = new Date().toLocaleDateString('tr-TR');
            const fileName = `${relatedRequest}_MANUAL_${Date.now()}.pdf`;
            
            newRow.className = 'report-row';
            newRow.setAttribute('onclick', 'selectReportRow(this)');
            
            newRow.innerHTML = `
                <td>${reportName}</td>
                <td>${relatedRequest}</td>
                <td>${currentUser.name}</td>
                <td>${today}</td>
                <td class="report-actions">
                    <button class="action-btn view" onclick="viewReportPdf('${fileName}', '${relatedRequest}')">📄 Görüntüle</button>
                    <button class="action-btn download" onclick="downloadReportPdf('${fileName}')" style="display: none;">📥 İndir</button>
                </td>
            `;
            
            reportTableBody.insertBefore(newRow, reportTableBody.firstChild);
            
            // Configure download button visibility
            configureActionButtons();
            
            closeUploadReportModal();
            showToast(`✅ ${t('report_uploaded')}: ${reportName}`, 'success');
            addLogEntry(`${currentUser.name}, ${reportName} raporunu yükledi`);
        }

        // Log Functions
        function addLogEntry(message) {
            const timestamp = new Date().toLocaleString('tr-TR');
            const logEntry = {
                time: timestamp,
                message: message,
                user: currentUser.name
            };
            
            logEntries.unshift(logEntry);
            
            // Keep only last 50 entries
            if (logEntries.length > 50) {
                logEntries = logEntries.slice(0, 50);
            }
            
            updateActivityPanel();
        }

        function updateActivityPanel() {
            const activityContent = document.getElementById('activityContent');
            activityContent.innerHTML = '';
            
            logEntries.forEach(entry => {
                const entryDiv = document.createElement('div');
                entryDiv.className = 'activity-entry';
                entryDiv.innerHTML = `
                    <div class="activity-time">${entry.time}</div>
                    <div class="activity-message">${entry.message}</div>
                `;
                activityContent.appendChild(entryDiv);
            });
        }

        function toggleActivityPanel() {
            const activityPanel = document.getElementById('activityPanel');
            const activityToggle = document.getElementById('activityToggle');
            
            if (activityPanel.classList.contains('active')) {
                activityPanel.classList.remove('active');
                activityToggle.style.display = 'block';
            } else {
                activityPanel.classList.add('active');
                activityToggle.style.display = 'none';
                updateActivityPanel();
            }
        }

        function deleteReport(button) {
            const row = button.closest('tr');
            const reportName = row.cells[0].textContent;
            
            if (confirm(`"${reportName}" raporunu silmek istediğinizden emin misiniz?`)) {
                row.remove();
                showToast(`🗑️ Rapor silindi: ${reportName}`, 'success');
                addLogEntry(`${currentUser.name}, "${reportName}" raporunu sildi`);
            }
        }

        // Click outside to close panels
        document.addEventListener('click', function(e) {
            if (!e.target.closest('.smart-panel') && !e.target.closest('.data-table')) {
                hideSmartPanel();
            }
        });

        // Initialize Application
        document.addEventListener('DOMContentLoaded', function() {
            initializeTheme();
            initializeLanguage();
            
            if (!checkLoginStatus()) {
                showLoginScreen();
            }
            
            // Setup login form
            document.getElementById('loginForm').addEventListener('submit', handleLogin);
            
            // Setup menu navigation
            document.querySelectorAll('.menu-item').forEach(item => {
                item.addEventListener('click', function() {
                    const module = this.dataset.module;
                    if (module) {
                        switchModule(module);
                    }
                });
            });
            
            // Setup filter functionality
            const searchInput = document.getElementById('searchInput');
            const statusFilter = document.getElementById('statusFilter');
            const dateFilter = document.getElementById('dateFilter');
            
            [searchInput, statusFilter, dateFilter].forEach(input => {
                input.addEventListener('input', function() {
                    // Filter functionality would go here
                    // For demo, we'll just show a message
                });
            });
            
            // Setup report search
            const reportSearchInput = document.getElementById('reportSearchInput');
            if (reportSearchInput) {
                reportSearchInput.addEventListener('input', function() {
                    // Report search functionality would go here
                });
            }
            
            // Initialize with some log entries
            addLogEntry('Sistem başlatıldı');
        });

        // Element SDK Implementation
        const element = {
            defaultConfig: defaultConfig,
            
            render: async function(config) {
                const systemName = config.system_name || defaultConfig.system_name;
                const companyName = config.company_name || defaultConfig.company_name;
                const versionNumber = config.version_number || defaultConfig.version_number;
                
                // Update system title
                const systemTitle = document.getElementById('systemTitle');
                if (systemTitle) {
                    systemTitle.textContent = systemName;
                }
            },
            
            mapToCapabilities: function(config) {
                return {
                    recolorables: [],
                    borderables: [],
                    fontEditable: undefined,
                    fontSizeable: undefined
                };
            },
            
            mapToEditPanelValues: function(config) {
                return new Map([
                    ["system_name", config.system_name || defaultConfig.system_name],
                    ["company_name", config.company_name || defaultConfig.company_name],
                    ["version_number", config.version_number || defaultConfig.version_number]
                ]);
            }
        };

        // Initialize Element SDK
        if (window.elementSdk) {
            window.elementSdk.init(element);
        }
    </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'99085b29a6b9e1e2',t:'MTc2MDc5Mzg2Ny4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
