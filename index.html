<!doctype html>
<html lang="tr">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SOF Ana Liste - SomTech RU</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="/_sdk/element_sdk.js"></script>
  <style>
        body {
            box-sizing: border-box;
            font-family: 'Calibri', 'Arial', sans-serif;
        }
        
        .table-cell {
            border: 1px solid #d1d5db;
            padding: 8px 6px;
            text-align: center;
            vertical-align: middle;
            font-size: 11px;
        }
        
        .table-header {
            background-color: #2459a0;
            color: white;
            font-weight: bold;
            font-size: 10px;
            padding: 10px 6px;
        }
        
        input[type="text"], input[type="number"], input[type="date"], select {
            border: 1px solid #d1d5db;
            padding: 4px 6px;
            font-size: 11px;
            width: 100%;
            border-radius: 3px;
        }
        
        input:focus, select:focus {
            outline: none;
            border-color: #2459a0;
            box-shadow: 0 0 0 2px rgba(36, 89, 160, 0.1);
        }
        
        .hover-row:hover {
            background-color: #f8fafc;
        }
        
        .status-pending {
            background-color: #fef3c7;
            color: #92400e;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 10px;
            font-weight: bold;
        }
        
        .status-approved {
            background-color: #d1fae5;
            color: #065f46;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 10px;
            font-weight: bold;
        }
        
        .status-rejected {
            background-color: #fee2e2;
            color: #991b1b;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 10px;
            font-weight: bold;
        }
        
        @media (max-width: 1024px) {
            .table-cell {
                padding: 4px 2px;
                font-size: 9px;
            }
            
            .table-header {
                font-size: 8px;
                padding: 6px 2px;
            }
            
            input, select {
                font-size: 9px;
                padding: 2px 4px;
            }
        }
        
        .scroll-container {
            overflow-x: auto;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
        }
        
        table {
            min-width: 1800px;
        }
    </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
 </head>
 <body class="bg-gray-50 min-h-full">
  <div class="container mx-auto px-4 py-6"><!-- √úst B√∂l√ºm -->
   <div class="bg-white rounded-lg shadow-lg p-6 mb-6"><!-- Logo ve Ba≈ülƒ±k -->
    <div class="flex justify-between items-center mb-6">
     <div class="flex items-center gap-4"><img src="https://www.somtech.com.tr/wp-content/uploads/2024/01/logo.png" alt="SomTech Logo" class="h-12" onerror="this.style.display='none';">
      <div>
       <h1 id="page-title" class="text-2xl font-bold text-gray-800">SOF ANA Lƒ∞STESƒ∞</h1>
       <p id="company-info" class="text-sm text-gray-600">SOMTECH RU - FABRƒ∞KA M√úD√úRL√úƒû√ú</p>
      </div>
     </div>
     <div class="text-right">
      <div class="bg-blue-100 px-4 py-2 rounded-lg border border-blue-200"><span class="text-sm font-semibold text-blue-700">üìÖ Tarih: </span> <span id="current-date" class="text-sm font-bold text-blue-800"></span>
      </div>
     </div>
    </div><!-- Arama ve Butonlar -->
    <div class="flex flex-wrap gap-4 items-center justify-between mb-6">
     <div class="flex gap-3"><button onclick="addRow()" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg font-semibold shadow-md transform hover:scale-105 transition-all duration-200 flex items-center gap-2"> <span class="text-lg">‚ûï</span> <span>Satƒ±r Ekle</span> </button> <button onclick="removeRow()" class="bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg font-semibold shadow-md transform hover:scale-105 transition-all duration-200 flex items-center gap-2"> <span class="text-lg">üóë</span> <span>Satƒ±r Sil</span> </button> <button onclick="clearAll()" class="bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-lg font-semibold shadow-md transform hover:scale-105 transition-all duration-200 flex items-center gap-2"> <span class="text-lg">üßπ</span> <span>Temizle</span> </button>
     </div>
     <div class="flex items-center gap-3"><label class="text-sm font-semibold text-gray-700">üîç SOF Arama:</label> <input type="text" id="search-input" placeholder="SOF-2025-001" class="border border-gray-300 rounded-lg px-3 py-2 w-48 focus:border-blue-500 focus:ring-2 focus:ring-blue-200" oninput="filterTable()"> <button onclick="clearSearch()" class="bg-blue-600 hover:bg-blue-700 text-white px-3 py-2 rounded-lg text-sm"> Temizle </button>
     </div>
    </div>
   </div><!-- Ana Tablo -->
   <div class="bg-white rounded-lg shadow-lg p-4">
    <div class="scroll-container">
     <table class="w-full border-collapse">
      <thead>
       <tr>
        <th class="table-cell table-header" style="width: 60px;">SIRA NO</th>
        <th class="table-cell table-header" style="width: 120px;">SOF TALEP NO</th>
        <th class="table-cell table-header" style="width: 120px;">ƒ∞STENEN TESLƒ∞M TARƒ∞Hƒ∞</th>
        <th class="table-cell table-header" style="width: 200px;">TALEP EDƒ∞LEN MALZEME</th>
        <th class="table-cell table-header" style="width: 150px;">DETAY 1 (MARKA, MODEL VB)</th>
        <th class="table-cell table-header" style="width: 150px;">DETAY 2 (PROJE, STANDART VB KODLAR)</th>
        <th class="table-cell table-header" style="width: 80px;">Bƒ∞Rƒ∞M</th>
        <th class="table-cell table-header" style="width: 100px;">ANA DEPO STOK Mƒ∞KTARI</th>
        <th class="table-cell table-header" style="width: 100px;">≈ûANTƒ∞YE DEPO STOK Mƒ∞KTARI</th>
        <th class="table-cell table-header" style="width: 100px;">TALEP Mƒ∞KTARI</th>
        <th class="table-cell table-header" style="width: 100px;">Sƒ∞PARƒ∞≈û Mƒ∞KTARI</th>
        <th class="table-cell table-header" style="width: 120px;">Bƒ∞Rƒ∞M Fƒ∞YAT (‚ÇΩ RUB)</th>
        <th class="table-cell table-header" style="width: 120px;">TOPLAM Fƒ∞YAT (‚ÇΩ RUB)</th>
        <th class="table-cell table-header" style="width: 120px;">TALEP EDEN</th>
        <th class="table-cell table-header" style="width: 150px;">A√áIKLAMA</th>
        <th class="table-cell table-header" style="width: 120px;">ONAY DURUMU</th>
       </tr>
      </thead>
      <tbody id="table-body"><!-- Satƒ±rlar buraya eklenecek -->
      </tbody>
      <tfoot>
       <tr class="bg-gray-100">
        <td colspan="12" class="table-cell text-right font-bold text-gray-800">GENEL TOPLAM (‚ÇΩ RUB):</td>
        <td class="table-cell font-bold text-lg text-green-800 bg-green-50" id="grand-total">‚ÇΩ 0.00</td>
        <td colspan="3" class="table-cell"></td>
       </tr>
      </tfoot>
     </table>
    </div><!-- ƒ∞statistikler -->
    <div class="mt-6 grid grid-cols-1 md:grid-cols-4 gap-4">
     <div class="bg-blue-50 p-4 rounded-lg border border-blue-200">
      <div class="text-blue-600 text-sm font-semibold">
       Toplam SOF Sayƒ±sƒ±
      </div>
      <div class="text-2xl font-bold text-blue-800" id="total-count">
       0
      </div>
     </div>
     <div class="bg-yellow-50 p-4 rounded-lg border border-yellow-200">
      <div class="text-yellow-600 text-sm font-semibold">
       Bekleyen Onaylar
      </div>
      <div class="text-2xl font-bold text-yellow-800" id="pending-count">
       0
      </div>
     </div>
     <div class="bg-green-50 p-4 rounded-lg border border-green-200">
      <div class="text-green-600 text-sm font-semibold">
       Onaylanan SOF'lar
      </div>
      <div class="text-2xl font-bold text-green-800" id="approved-count">
       0
      </div>
     </div>
     <div class="bg-red-50 p-4 rounded-lg border border-red-200">
      <div class="text-red-600 text-sm font-semibold">
       Reddedilen SOF'lar
      </div>
      <div class="text-2xl font-bold text-red-800" id="rejected-count">
       0
      </div>
     </div>
    </div>
   </div>
  </div>
  <script>
        let rowCount = 0;
        let sofCounter = 1;

        // Varsayƒ±lan konfig√ºrasyon
        const defaultConfig = {
            page_title: "SOF ANA Lƒ∞STESƒ∞",
            company_info: "SOMTECH RU - FABRƒ∞KA M√úD√úRL√úƒû√ú"
        };

        // Render fonksiyonu
        async function render(config) {
            document.getElementById('page-title').textContent = config.page_title || defaultConfig.page_title;
            document.getElementById('company-info').textContent = config.company_info || defaultConfig.company_info;
        }

        // Capabilities
        function mapToCapabilities(config) {
            return {
                recolorables: [],
                borderables: [],
                fontEditable: undefined,
                fontSizeable: undefined
            };
        }

        // Edit panel values
        function mapToEditPanelValues(config) {
            return new Map([
                ["page_title", config.page_title || defaultConfig.page_title],
                ["company_info", config.company_info || defaultConfig.company_info]
            ]);
        }

        // SDK ba≈ülatma
        if (window.elementSdk) {
            window.elementSdk.init({
                defaultConfig,
                render,
                mapToCapabilities,
                mapToEditPanelValues
            });
        }

        // Bug√ºn√ºn tarihini g√∂ster
        function setCurrentDate() {
            const today = new Date();
            const day = String(today.getDate()).padStart(2, '0');
            const month = String(today.getMonth() + 1).padStart(2, '0');
            const year = today.getFullYear();
            document.getElementById('current-date').textContent = `${day}.${month}.${year}`;
        }

        // SOF numarasƒ± √ºretme
        function generateSOFNumber() {
            const year = new Date().getFullYear();
            const number = String(sofCounter).padStart(3, '0');
            sofCounter++;
            return `SOF-${year}-${number}`;
        }

        // Satƒ±r ekleme fonksiyonu
        function addRow() {
            rowCount++;
            const tbody = document.getElementById('table-body');
            const row = document.createElement('tr');
            row.className = 'hover-row border-b border-gray-200';
            
            const sofNumber = generateSOFNumber();
            
            row.innerHTML = `
                <td class="table-cell font-semibold text-gray-700">${rowCount}</td>
                <td class="table-cell">
                    <input type="text" class="sof-number bg-blue-50 font-bold text-blue-800" value="${sofNumber}" readonly>
                </td>
                <td class="table-cell">
                    <input type="date" class="delivery-date">
                </td>
                <td class="table-cell">
                    <input type="text" class="material-name" placeholder="Malzeme adƒ±">
                </td>
                <td class="table-cell">
                    <input type="text" class="detail1" placeholder="Marka/Model">
                </td>
                <td class="table-cell">
                    <input type="text" class="detail2" placeholder="Proje kodu">
                </td>
                <td class="table-cell">
                    <input type="text" class="unit" placeholder="Adet/Kg/M¬≤">
                </td>
                <td class="table-cell">
                    <input type="number" class="main-stock" placeholder="0" min="0" step="0.01">
                </td>
                <td class="table-cell">
                    <input type="number" class="site-stock" placeholder="0" min="0" step="0.01">
                </td>
                <td class="table-cell">
                    <input type="number" class="request-qty" placeholder="0" min="0" step="0.01" oninput="calculateRowTotal(this)">
                </td>
                <td class="table-cell">
                    <input type="number" class="order-qty" placeholder="0" min="0" step="0.01">
                </td>
                <td class="table-cell">
                    <input type="number" class="unit-price" placeholder="0.00" min="0" step="0.01" oninput="calculateRowTotal(this)">
                </td>
                <td class="table-cell total-price font-bold text-green-800 bg-green-50">‚ÇΩ 0.00</td>
                <td class="table-cell">
                    <input type="text" class="requester" placeholder="Talep eden ki≈üi">
                </td>
                <td class="table-cell">
                    <input type="text" class="description" placeholder="A√ßƒ±klama">
                </td>
                <td class="table-cell">
                    <select class="approval-status" onchange="updateStatusStyle(this)">
                        <option value="Bekliyor">Bekliyor</option>
                        <option value="Onaylandƒ±">Onaylandƒ±</option>
                        <option value="Reddedildi">Reddedildi</option>
                    </select>
                </td>
            `;
            
            tbody.appendChild(row);
            
            // Durum stilini g√ºncelle
            const statusSelect = row.querySelector('.approval-status');
            updateStatusStyle(statusSelect);
            
            // ƒ∞statistikleri g√ºncelle
            updateStatistics();
            
            showMessage('Yeni SOF satƒ±rƒ± eklendi!', 'success');
        }

        // Durum stilini g√ºncelleme
        function updateStatusStyle(selectElement) {
            const value = selectElement.value;
            selectElement.className = 'approval-status ';
            
            if (value === 'Bekliyor') {
                selectElement.className += 'status-pending';
            } else if (value === 'Onaylandƒ±') {
                selectElement.className += 'status-approved';
            } else if (value === 'Reddedildi') {
                selectElement.className += 'status-rejected';
            }
            
            updateStatistics();
        }

        // Satƒ±r silme fonksiyonu
        function removeRow() {
            const tbody = document.getElementById('table-body');
            if (tbody.children.length > 0) {
                if (confirm('Son satƒ±rƒ± silmek istediƒüinizden emin misiniz?')) {
                    tbody.removeChild(tbody.lastElementChild);
                    rowCount = Math.max(0, rowCount - 1);
                    updateRowNumbers();
                    calculateGrandTotal();
                    updateStatistics();
                    showMessage('Satƒ±r ba≈üarƒ±yla silindi!', 'success');
                }
            } else {
                showMessage('Silinecek satƒ±r bulunamadƒ±!', 'warning');
            }
        }

        // Satƒ±r numaralarƒ±nƒ± g√ºncelleme
        function updateRowNumbers() {
            const tbody = document.getElementById('table-body');
            Array.from(tbody.children).forEach((row, index) => {
                row.children[0].textContent = index + 1;
            });
            rowCount = tbody.children.length;
        }

        // Satƒ±r toplamƒ±nƒ± hesaplama
        function calculateRowTotal(input) {
            const row = input.closest('tr');
            const requestQty = parseFloat(row.querySelector('.request-qty').value) || 0;
            const unitPrice = parseFloat(row.querySelector('.unit-price').value) || 0;
            
            const total = requestQty * unitPrice;
            
            const totalCell = row.querySelector('.total-price');
            totalCell.textContent = `‚ÇΩ ${total.toLocaleString('tr-TR', {minimumFractionDigits: 2, maximumFractionDigits: 2})}`;
            
            calculateGrandTotal();
        }

        // Genel toplam hesaplama
        function calculateGrandTotal() {
            const totalCells = document.querySelectorAll('.total-price');
            let grandTotal = 0;
            
            totalCells.forEach(cell => {
                const value = cell.textContent.replace('‚ÇΩ', '').replace(/\./g, '').replace(',', '.').trim();
                grandTotal += parseFloat(value) || 0;
            });
            
            document.getElementById('grand-total').textContent = `‚ÇΩ ${grandTotal.toLocaleString('tr-TR', {minimumFractionDigits: 2, maximumFractionDigits: 2})}`;
        }

        // ƒ∞statistikleri g√ºncelleme
        function updateStatistics() {
            const tbody = document.getElementById('table-body');
            const rows = tbody.children;
            
            let totalCount = rows.length;
            let pendingCount = 0;
            let approvedCount = 0;
            let rejectedCount = 0;
            
            Array.from(rows).forEach(row => {
                const status = row.querySelector('.approval-status').value;
                if (status === 'Bekliyor') pendingCount++;
                else if (status === 'Onaylandƒ±') approvedCount++;
                else if (status === 'Reddedildi') rejectedCount++;
            });
            
            document.getElementById('total-count').textContent = totalCount;
            document.getElementById('pending-count').textContent = pendingCount;
            document.getElementById('approved-count').textContent = approvedCount;
            document.getElementById('rejected-count').textContent = rejectedCount;
        }

        // Tablo filtreleme
        function filterTable() {
            const searchValue = document.getElementById('search-input').value.toLowerCase();
            const tbody = document.getElementById('table-body');
            const rows = tbody.children;
            
            Array.from(rows).forEach(row => {
                const sofNumber = row.querySelector('.sof-number').value.toLowerCase();
                if (sofNumber.includes(searchValue)) {
                    row.style.display = '';
                } else {
                    row.style.display = 'none';
                }
            });
        }

        // Aramayƒ± temizleme
        function clearSearch() {
            document.getElementById('search-input').value = '';
            filterTable();
        }

        // T√ºm√ºn√º temizleme
        function clearAll() {
            if (confirm('T√ºm SOF verilerini silmek istediƒüinizden emin misiniz?\nBu i≈ülem geri alƒ±namaz!')) {
                document.getElementById('table-body').innerHTML = '';
                rowCount = 0;
                sofCounter = 1;
                calculateGrandTotal();
                updateStatistics();
                showMessage('T√ºm veriler temizlendi!', 'success');
            }
        }

        // Mesaj g√∂sterme
        function showMessage(message, type = 'info') {
            const messageDiv = document.createElement('div');
            messageDiv.className = `fixed top-4 right-4 z-50 px-4 py-2 rounded-lg text-white font-semibold shadow-lg transform transition-all duration-300 ${
                type === 'success' ? 'bg-green-600' : 
                type === 'warning' ? 'bg-yellow-600' : 
                type === 'error' ? 'bg-red-600' : 'bg-blue-600'
            }`;
            messageDiv.textContent = message;
            
            document.body.appendChild(messageDiv);
            
            setTimeout(() => messageDiv.classList.add('translate-x-0'), 100);
            setTimeout(() => {
                messageDiv.classList.add('translate-x-full', 'opacity-0');
                setTimeout(() => document.body.removeChild(messageDiv), 300);
            }, 3000);
        }

        // Klavye kƒ±sayollarƒ±
        document.addEventListener('keydown', function(e) {
            if (e.ctrlKey && e.key === 'n') {
                e.preventDefault();
                addRow();
            }
            
            if (e.key === 'Delete' && e.target.closest('table')) {
                removeRow();
            }
            
            if (e.ctrlKey && e.key === 'f') {
                e.preventDefault();
                document.getElementById('search-input').focus();
            }
        });

        // Sayfa y√ºklendiƒüinde
        document.addEventListener('DOMContentLoaded', function() {
            setCurrentDate();
            
            // 3 √∂rnek satƒ±r ekle
            for (let i = 0; i < 3; i++) {
                addRow();
            }
            
            setTimeout(() => {
                showMessage('SOF Ana Liste hazƒ±r! Klavye kƒ±sayollarƒ±: Ctrl+N (Yeni Satƒ±r), Ctrl+F (Arama), Delete (Satƒ±r Sil)', 'info');
            }, 1000);
        });
    </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'98fe3c84f593d35d',t:'MTc2MDY4Nzc1NS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
